/*! Eleva Props Plugin v1.0.0-rc.2 | MIT License | https://elevajs.com */
var t,e;t=this,e=function(t){"use strict";class e{static expressionPattern=/\{\{\s*(.*?)\s*\}\}/g;static parse(t,e){return"string"!=typeof t?t:t.replace(this.expressionPattern,(t,n)=>this.evaluate(n,e))}static evaluate(t,e){if("string"!=typeof t)return t;try{return new Function("data",`with(data) { return ${t}; }`)(e)}catch{return""}}}t.PropsPlugin={name:"props",version:"1.0.0-rc.2",description:"Advanced props data handling for complex data structures with automatic type detection and reactivity",install(t,n={}){const{enableAutoParsing:a=!0,enableReactivity:o=!0,onError:r=null}=n,i=t=>{try{if("string"!=typeof t)return t;if("true"===t)return!0;if("false"===t)return!1;if("null"===t)return null;if("undefined"===t)return;if(t.startsWith("{")||t.startsWith("["))try{return JSON.parse(t)}catch(e){throw new Error(`Invalid JSON: ${t}`)}if("1"===t)return!0;if("0"===t)return!1;if(""===t)return!0;if(!isNaN(t)&&""!==t&&!isNaN(parseFloat(t)))return Number(t);if(t.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)){const e=new Date(t);if(!isNaN(e.getTime()))return e}return t}catch(e){return r&&r(e,t),t}},s=e=>{const n={};return Object.entries(e).forEach(([e,a])=>{n[e]=a&&"object"==typeof a&&"value"in a&&"watch"in a?a:new t.signal(a)}),n};t._extractProps=t=>{const e={},n=t.attributes;for(let o=n.length-1;o>=0;o--){const r=n[o];if(r.name.startsWith(":")){const n=r.name.slice(1),o=a?i(r.value):r.value;e[n]=o,t.removeAttribute(r.name)}}return e};const c=t.mount;t.mount=async(e,n,a={})=>{const r=o?s(a):a;return await c.call(t,e,n,r)};const l=t._mountComponents,p=new WeakMap,f=new Set;t._mountComponents=async(n,a,r)=>{for(const[e,i]of Object.entries(a))if(e)for(const a of n.querySelectorAll(e)){if(!(a instanceof HTMLElement))continue;const e=t._extractProps(a);let c=e,l=p.get(n);if(!l){let t=n;for(;t&&!l;){if(t._eleva_instance&&t._eleva_instance.data){l=t._eleva_instance.data,p.set(n,l);break}t=t.parentElement}}if(o&&l){const n={};Object.keys(e).forEach(e=>{l[e]&&l[e]instanceof t.signal&&(n[e]=l[e])}),c={...e,...n}}let u=c;if(o){const t={};Object.entries(c).forEach(([e,n])=>{n&&"object"==typeof n&&"value"in n&&"watch"in n||(t[e]=n)}),u={...s(t),...c}}const d=await t.mount(a,i,u);d&&!r.includes(d)&&(r.push(d),o&&Object.keys(e).length>0&&!l&&f.add({instance:d,extractedProps:e,container:n,component:i}))}if(o&&f.size>0)for(const n of f){const{instance:a,extractedProps:o,container:r,component:i}=n;let s=p.get(r);if(!s){let t=r;for(;t&&!s;){if(t._eleva_instance&&t._eleva_instance.data){s=t._eleva_instance.data,p.set(r,s);break}t=t.parentElement}}if(s){const r={};if(Object.keys(o).forEach(e=>{s[e]&&s[e]instanceof t.signal&&(r[e]=s[e])}),Object.keys(r).length>0){Object.assign(a.data,r),Object.keys(r).forEach(n=>{const o=r[n];o&&"function"==typeof o.watch&&o.watch(()=>{const n=t._components.get(i)||i;if(n&&n.template){const o="function"==typeof n.template?n.template(a.data):n.template,r=e.parse(o,a.data);t.renderer.patchDOM(a.container,r)}})});const n=t._components.get(i)||i;if(n&&n.template){const o="function"==typeof n.template?n.template(a.data):n.template,r=e.parse(o,a.data);t.renderer.patchDOM(a.container,r)}}f.delete(n)}}},t.props={parse:t=>a?i(t):t,detectType:t=>null===t?"null":void 0===t?"undefined":"boolean"==typeof t?"boolean":"number"==typeof t?"number":"string"==typeof t?"string":"function"==typeof t?"function":t instanceof Date?"date":t instanceof Map?"map":t instanceof Set?"set":Array.isArray(t)?"array":"object"==typeof t?"object":"unknown"},t._originalExtractProps=t._extractProps,t._originalMount=c,t._originalMountComponents=l},uninstall(t){t._originalExtractProps&&(t._extractProps=t._originalExtractProps,delete t._originalExtractProps),t._originalMount&&(t.mount=t._originalMount,delete t._originalMount),t._originalMountComponents&&(t._mountComponents=t._originalMountComponents,delete t._originalMountComponents),t.props&&delete t.props}}},"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).ElevaPropsPlugin={});
//# sourceMappingURL=props.umd.min.js.map
