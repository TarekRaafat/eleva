{"version":3,"file":"eleva.umd.js","sources":["../src/modules/TemplateEngine.js","../src/modules/Signal.js","../src/modules/Emitter.js","../src/modules/Renderer.js","../src/core/Eleva.js"],"sourcesContent":["\"use strict\";\n\n/**\n * @class ðŸ”’ TemplateEngine\n * @classdesc A secure template engine that handles interpolation and dynamic attribute parsing.\n * Provides a safe way to evaluate expressions in templates while preventing XSS attacks.\n * All methods are static and can be called directly on the class.\n *\n * @example\n * const template = \"Hello, {{name}}!\";\n * const data = { name: \"World\" };\n * const result = TemplateEngine.parse(template, data); // Returns: \"Hello, World!\"\n */\nexport class TemplateEngine {\n  /**\n   * @private {RegExp} Regular expression for matching template expressions in the format {{ expression }}\n   * @type {RegExp}\n   */\n  static expressionPattern = /\\{\\{\\s*(.*?)\\s*\\}\\}/g;\n\n  /**\n   * Parses a template string, replacing expressions with their evaluated values.\n   * Expressions are evaluated in the provided data context.\n   *\n   * @public\n   * @static\n   * @param {string} template - The template string to parse.\n   * @param {Record<string, unknown>} data - The data context for evaluating expressions.\n   * @returns {string} The parsed template with expressions replaced by their values.\n   * @example\n   * const result = TemplateEngine.parse(\"{{user.name}} is {{user.age}} years old\", {\n   *   user: { name: \"John\", age: 30 }\n   * }); // Returns: \"John is 30 years old\"\n   */\n  static parse(template, data) {\n    if (typeof template !== \"string\") return template;\n    return template.replace(this.expressionPattern, (_, expression) =>\n      this.evaluate(expression, data)\n    );\n  }\n\n  /**\n   * Evaluates an expression in the context of the provided data object.\n   * Note: This does not provide a true sandbox and evaluated expressions may access global scope.\n   * The use of the `with` statement is necessary for expression evaluation but has security implications.\n   * Expressions should be carefully validated before evaluation.\n   *\n   * @public\n   * @static\n   * @param {string} expression - The expression to evaluate.\n   * @param {Record<string, unknown>} data - The data context for evaluation.\n   * @returns {unknown} The result of the evaluation, or an empty string if evaluation fails.\n   * @example\n   * const result = TemplateEngine.evaluate(\"user.name\", { user: { name: \"John\" } }); // Returns: \"John\"\n   * const age = TemplateEngine.evaluate(\"user.age\", { user: { age: 30 } }); // Returns: 30\n   */\n  static evaluate(expression, data) {\n    if (typeof expression !== \"string\") return expression;\n    try {\n      return new Function(\"data\", `with(data) { return ${expression}; }`)(data);\n    } catch {\n      return \"\";\n    }\n  }\n}\n","\"use strict\";\n\n/**\n * @class âš¡ Signal\n * @classdesc A reactive data holder that enables fine-grained reactivity in the Eleva framework.\n * Signals notify registered watchers when their value changes, enabling efficient DOM updates\n * through targeted patching rather than full re-renders.\n * Updates are batched using microtasks to prevent multiple synchronous notifications.\n * The class is generic, allowing type-safe handling of any value type T.\n *\n * @example\n * const count = new Signal(0);\n * count.watch((value) => console.log(`Count changed to: ${value}`));\n * count.value = 1; // Logs: \"Count changed to: 1\"\n * @template T\n */\nexport class Signal {\n  /**\n   * Creates a new Signal instance with the specified initial value.\n   *\n   * @public\n   * @param {T} value - The initial value of the signal.\n   */\n  constructor(value) {\n    /** @private {T} Internal storage for the signal's current value */\n    this._value = value;\n    /** @private {Set<(value: T) => void>} Collection of callback functions to be notified when value changes */\n    this._watchers = new Set();\n    /** @private {boolean} Flag to prevent multiple synchronous watcher notifications and batch updates into microtasks */\n    this._pending = false;\n  }\n\n  /**\n   * Gets the current value of the signal.\n   *\n   * @public\n   * @returns {T} The current value.\n   */\n  get value() {\n    return this._value;\n  }\n\n  /**\n   * Sets a new value for the signal and notifies all registered watchers if the value has changed.\n   * The notification is batched using microtasks to prevent multiple synchronous updates.\n   *\n   * @public\n   * @param {T} newVal - The new value to set.\n   * @returns {void}\n   */\n  set value(newVal) {\n    if (this._value === newVal) return;\n\n    this._value = newVal;\n    this._notify();\n  }\n\n  /**\n   * Registers a watcher function that will be called whenever the signal's value changes.\n   * The watcher will receive the new value as its argument.\n   *\n   * @public\n   * @param {(value: T) => void} fn - The callback function to invoke on value change.\n   * @returns {() => boolean} A function to unsubscribe the watcher.\n   * @example\n   * const unsubscribe = signal.watch((value) => console.log(value));\n   * // Later...\n   * unsubscribe(); // Stops watching for changes\n   */\n  watch(fn) {\n    this._watchers.add(fn);\n    return () => this._watchers.delete(fn);\n  }\n\n  /**\n   * Notifies all registered watchers of a value change using microtask scheduling.\n   * Uses a pending flag to batch multiple synchronous updates into a single notification.\n   * All watcher callbacks receive the current value when executed.\n   *\n   * @private\n   * @returns {void}\n   */\n  _notify() {\n    if (this._pending) return;\n\n    this._pending = true;\n    queueMicrotask(() => {\n      /** @type {(fn: (value: T) => void) => void} */\n      this._watchers.forEach((fn) => fn(this._value));\n      this._pending = false;\n    });\n  }\n}\n","\"use strict\";\n\n/**\n * @class ðŸ“¡ Emitter\n * @classdesc A robust event emitter that enables inter-component communication through a publish-subscribe pattern.\n * Components can emit events and listen for events from other components, facilitating loose coupling\n * and reactive updates across the application.\n * Events are handled synchronously in the order they were registered, with proper cleanup\n * of unsubscribed handlers.\n * Event names should follow the format 'namespace:action' (e.g., 'user:login', 'cart:update').\n *\n * @example\n * const emitter = new Emitter();\n * emitter.on('user:login', (user) => console.log(`User logged in: ${user.name}`));\n * emitter.emit('user:login', { name: 'John' }); // Logs: \"User logged in: John\"\n */\nexport class Emitter {\n  /**\n   * Creates a new Emitter instance.\n   *\n   * @public\n   */\n  constructor() {\n    /** @private {Map<string, Set<(data: unknown) => void>>} Map of event names to their registered handler functions */\n    this._events = new Map();\n  }\n\n  /**\n   * Registers an event handler for the specified event name.\n   * The handler will be called with the event data when the event is emitted.\n   * Event names should follow the format 'namespace:action' for consistency.\n   *\n   * @public\n   * @param {string} event - The name of the event to listen for (e.g., 'user:login').\n   * @param {(data: unknown) => void} handler - The callback function to invoke when the event occurs.\n   * @returns {() => void} A function to unsubscribe the event handler.\n   * @example\n   * const unsubscribe = emitter.on('user:login', (user) => console.log(user));\n   * // Later...\n   * unsubscribe(); // Stops listening for the event\n   */\n  on(event, handler) {\n    if (!this._events.has(event)) this._events.set(event, new Set());\n\n    this._events.get(event).add(handler);\n    return () => this.off(event, handler);\n  }\n\n  /**\n   * Removes an event handler for the specified event name.\n   * If no handler is provided, all handlers for the event are removed.\n   * Automatically cleans up empty event sets to prevent memory leaks.\n   *\n   * @public\n   * @param {string} event - The name of the event to remove handlers from.\n   * @param {(data: unknown) => void} [handler] - The specific handler function to remove.\n   * @returns {void}\n   * @example\n   * // Remove a specific handler\n   * emitter.off('user:login', loginHandler);\n   * // Remove all handlers for an event\n   * emitter.off('user:login');\n   */\n  off(event, handler) {\n    if (!this._events.has(event)) return;\n    if (handler) {\n      const handlers = this._events.get(event);\n      handlers.delete(handler);\n      // Remove the event if there are no handlers left\n      if (handlers.size === 0) this._events.delete(event);\n    } else {\n      this._events.delete(event);\n    }\n  }\n\n  /**\n   * Emits an event with the specified data to all registered handlers.\n   * Handlers are called synchronously in the order they were registered.\n   * If no handlers are registered for the event, the emission is silently ignored.\n   *\n   * @public\n   * @param {string} event - The name of the event to emit.\n   * @param {...unknown} args - Optional arguments to pass to the event handlers.\n   * @returns {void}\n   * @example\n   * // Emit an event with data\n   * emitter.emit('user:login', { name: 'John', role: 'admin' });\n   * // Emit an event with multiple arguments\n   * emitter.emit('cart:update', { items: [] }, { total: 0 });\n   */\n  emit(event, ...args) {\n    if (!this._events.has(event)) return;\n    this._events.get(event).forEach((handler) => handler(...args));\n  }\n}\n","\"use strict\";\n\n/**\n * A regular expression to match hyphenated lowercase letters.\n * @private\n * @type {RegExp}\n */\nconst CAMEL_RE = /-([a-z])/g;\n\n/**\n * @class ðŸŽ¨ Renderer\n * @classdesc A high-performance DOM renderer that implements an optimized direct DOM diffing algorithm.\n *\n * Key features:\n * - Single-pass diffing algorithm for efficient DOM updates\n * - Key-based node reconciliation for optimal performance\n * - Intelligent attribute handling for ARIA, data attributes, and boolean properties\n * - Preservation of special Eleva-managed instances and style elements\n * - Memory-efficient with reusable temporary containers\n *\n * The renderer is designed to minimize DOM operations while maintaining\n * exact attribute synchronization and proper node identity preservation.\n * It's particularly optimized for frequent updates and complex DOM structures.\n *\n * @example\n * const renderer = new Renderer();\n * const container = document.getElementById(\"app\");\n * const newHtml = \"<div>Updated content</div>\";\n * renderer.patchDOM(container, newHtml);\n */\nexport class Renderer {\n  /**\n   * Creates a new Renderer instance.\n   * @public\n   */\n  constructor() {\n    /**\n     * A temporary container to hold the new HTML content while diffing.\n     * @private\n     * @type {HTMLElement}\n     */\n    this._tempContainer = document.createElement(\"div\");\n  }\n\n  /**\n   * Patches the DOM of the given container with the provided HTML string.\n   *\n   * @public\n   * @param {HTMLElement} container - The container whose DOM will be patched.\n   * @param {string} newHtml - The new HTML string.\n   * @throws {TypeError} If the container is not an HTMLElement or newHtml is not a string.\n   * @throws {Error} If the DOM patching fails.\n   * @returns {void}\n   */\n  patchDOM(container, newHtml) {\n    if (!(container instanceof HTMLElement)) {\n      throw new TypeError(\"Container must be an HTMLElement\");\n    }\n    if (typeof newHtml !== \"string\") {\n      throw new TypeError(\"newHtml must be a string\");\n    }\n\n    try {\n      this._tempContainer.innerHTML = newHtml;\n      this._diff(container, this._tempContainer);\n    } catch (error) {\n      throw new Error(`Failed to patch DOM: ${error.message}`);\n    }\n  }\n\n  /**\n   * Performs a diff between two DOM nodes and patches the old node to match the new node.\n   *\n   * @private\n   * @param {Node} oldParent - The old parent node to be patched.\n   * @param {Node} newParent - The new parent node to compare.\n   * @returns {void}\n   */\n  _diff(oldParent, newParent) {\n    if (oldParent === newParent || oldParent.isEqualNode?.(newParent)) return;\n\n    const oldChildren = Array.from(oldParent.childNodes);\n    const newChildren = Array.from(newParent.childNodes);\n    let oldStartIdx = 0,\n      newStartIdx = 0;\n    let oldEndIdx = oldChildren.length - 1;\n    let newEndIdx = newChildren.length - 1;\n    let oldKeyMap = null;\n\n    while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {\n      let oldStartNode = oldChildren[oldStartIdx];\n      let newStartNode = newChildren[newStartIdx];\n\n      if (!oldStartNode) {\n        oldStartIdx++;\n        continue;\n      }\n      if (!newStartNode) {\n        newStartIdx++;\n        continue;\n      }\n\n      if (this._keysMatch(oldStartNode, newStartNode)) {\n        this._patchNode(oldStartNode, newStartNode);\n        oldStartIdx++;\n        newStartIdx++;\n      } else {\n        oldKeyMap ??= this._createKeyMap(oldChildren, oldStartIdx, oldEndIdx);\n\n        const newKey =\n          newStartNode.nodeType === Node.ELEMENT_NODE\n            ? newStartNode.getAttribute(\"key\")\n            : null;\n        const moveIndex = newKey ? oldKeyMap.get(newKey) : undefined;\n        const oldNodeToMove =\n          moveIndex !== undefined ? oldChildren[moveIndex] : null;\n\n        if (oldNodeToMove) {\n          this._patchNode(oldNodeToMove, newStartNode);\n          oldParent.insertBefore(oldNodeToMove, oldStartNode);\n\n          if (moveIndex !== undefined) oldChildren[moveIndex] = null;\n        } else {\n          oldParent.insertBefore(newStartNode.cloneNode(true), oldStartNode);\n        }\n        newStartIdx++;\n      }\n    }\n\n    // Cleanup\n    if (oldStartIdx > oldEndIdx) {\n      const refNode = newChildren[newEndIdx + 1]\n        ? oldChildren[oldStartIdx]\n        : null;\n      for (let i = newStartIdx; i <= newEndIdx; i++) {\n        if (newChildren[i])\n          oldParent.insertBefore(newChildren[i].cloneNode(true), refNode);\n      }\n    } else if (newStartIdx > newEndIdx) {\n      for (let i = oldStartIdx; i <= oldEndIdx; i++) {\n        const node = oldChildren[i];\n        if (\n          node &&\n          !(node.nodeName === \"STYLE\" && node.hasAttribute(\"data-e-style\"))\n        ) {\n          oldParent.removeChild(node);\n        }\n      }\n    }\n  }\n\n  /**\n   * Checks if the node types match.\n   *\n   * @private\n   * @param {Node} oldNode - The old node.\n   * @param {Node} newNode - The new node.\n   * @returns {boolean} True if the nodes match, false otherwise.\n   */\n  _keysMatch(oldNode, newNode) {\n    if (oldNode.nodeType !== Node.ELEMENT_NODE) return true;\n    const oldKey = oldNode.getAttribute(\"key\");\n    const newKey = newNode.getAttribute(\"key\");\n    return oldKey === newKey;\n  }\n\n  /**\n   * Patches a node.\n   *\n   * @private\n   * @param {Node} oldNode - The old node to patch.\n   * @param {Node} newNode - The new node to patch.\n   * @returns {void}\n   */\n  _patchNode(oldNode, newNode) {\n    if (oldNode?._eleva_instance) return;\n\n    if (\n      oldNode.nodeType !== newNode.nodeType ||\n      oldNode.nodeName !== newNode.nodeName\n    ) {\n      oldNode.replaceWith(newNode.cloneNode(true));\n      return;\n    }\n\n    if (oldNode.nodeType === Node.ELEMENT_NODE) {\n      const oldEl = oldNode;\n      const newEl = newNode;\n      this._updateAttributes(oldEl, newEl);\n      this._diff(oldEl, newEl);\n    } else if (\n      oldNode.nodeType === Node.TEXT_NODE &&\n      oldNode.nodeValue !== newNode.nodeValue\n    ) {\n      oldNode.nodeValue = newNode.nodeValue;\n    }\n  }\n\n  /**\n   * Updates the attributes of an element.\n   *\n   * @private\n   * @param {HTMLElement} oldEl - The old element to update.\n   * @param {HTMLElement} newEl - The new element to update.\n   * @returns {void}\n   */\n  _updateAttributes(oldEl, newEl) {\n    const oldAttrs = oldEl.attributes;\n    const newAttrs = newEl.attributes;\n\n    // Single pass for new/updated attributes\n    for (let i = 0; i < newAttrs.length; i++) {\n      const { name, value } = newAttrs[i];\n      if (name[0] === \"@\" || oldEl.getAttribute(name) === value) continue;\n\n      oldEl.setAttribute(name, value);\n\n      if (name[0] === \"a\" && name[4] === \"-\") {\n        const s = name.slice(5);\n        oldEl[\"aria\" + s.replace(CAMEL_RE, (_, l) => l.toUpperCase())] = value;\n      } else if (name[0] === \"d\" && name[3] === \"-\") {\n        oldEl.dataset[name.slice(5)] = value;\n      } else {\n        const prop = name.includes(\"-\")\n          ? name.replace(CAMEL_RE, (_, l) => l.toUpperCase())\n          : name;\n\n        if (prop in oldEl) {\n          const descriptor = Object.getOwnPropertyDescriptor(\n            Object.getPrototypeOf(oldEl),\n            prop\n          );\n          const isBoolean =\n            typeof oldEl[prop] === \"boolean\" ||\n            (descriptor?.get &&\n              typeof descriptor.get.call(oldEl) === \"boolean\");\n          if (isBoolean) {\n            oldEl[prop] =\n              value !== \"false\" &&\n              (value === \"\" || value === prop || value === \"true\");\n          } else {\n            oldEl[prop] = value;\n          }\n        }\n      }\n    }\n\n    // Remove any attributes no longer present\n    for (let i = oldAttrs.length - 1; i >= 0; i--) {\n      const name = oldAttrs[i].name;\n      if (!newEl.hasAttribute(name)) {\n        oldEl.removeAttribute(name);\n      }\n    }\n  }\n\n  /**\n   * Creates a key map for the children of a parent node.\n   *\n   * @private\n   * @param {Array<Node>} children - The children of the parent node.\n   * @param {number} start - The start index of the children.\n   * @param {number} end - The end index of the children.\n   * @returns {Map<string, number>} A map of key to child index.\n   */\n  _createKeyMap(children, start, end) {\n    const map = new Map();\n    for (let i = start; i <= end; i++) {\n      const child = children[i];\n      if (child?.nodeType === Node.ELEMENT_NODE) {\n        const key = child.getAttribute(\"key\");\n        if (key) map.set(key, i);\n      }\n    }\n    return map;\n  }\n}\n","\"use strict\";\n\nimport { TemplateEngine } from \"../modules/TemplateEngine.js\";\nimport { Signal } from \"../modules/Signal.js\";\nimport { Emitter } from \"../modules/Emitter.js\";\nimport { Renderer } from \"../modules/Renderer.js\";\n\n/**\n * @typedef {Object} ComponentDefinition\n * @property {function(ComponentContext): (Record<string, unknown>|Promise<Record<string, unknown>>)} [setup]\n *           Optional setup function that initializes the component's state and returns reactive data\n * @property {(function(ComponentContext): string|Promise<string>)} template\n *           Required function that defines the component's HTML structure\n * @property {(function(ComponentContext): string)|string} [style]\n *           Optional function or string that provides component-scoped CSS styles\n * @property {Record<string, ComponentDefinition>} [children]\n *           Optional object defining nested child components\n */\n\n/**\n * @typedef {Object} ComponentContext\n * @property {Record<string, unknown>} props\n *           Component properties passed during mounting\n * @property {Emitter} emitter\n *           Event emitter instance for component event handling\n * @property {function<T>(value: T): Signal<T>} signal\n *           Factory function to create reactive Signal instances\n * @property {function(LifecycleHookContext): Promise<void>} [onBeforeMount]\n *           Hook called before component mounting\n * @property {function(LifecycleHookContext): Promise<void>} [onMount]\n *           Hook called after component mounting\n * @property {function(LifecycleHookContext): Promise<void>} [onBeforeUpdate]\n *           Hook called before component update\n * @property {function(LifecycleHookContext): Promise<void>} [onUpdate]\n *           Hook called after component update\n * @property {function(UnmountHookContext): Promise<void>} [onUnmount]\n *           Hook called during component unmounting\n */\n\n/**\n * @typedef {Object} LifecycleHookContext\n * @property {HTMLElement} container\n *           The DOM element where the component is mounted\n * @property {ComponentContext} context\n *           The component's reactive state and context data\n */\n\n/**\n * @typedef {Object} UnmountHookContext\n * @property {HTMLElement} container\n *           The DOM element where the component is mounted\n * @property {ComponentContext} context\n *           The component's reactive state and context data\n * @property {{\n *   watchers: Array<() => void>,    // Signal watcher cleanup functions\n *   listeners: Array<() => void>,   // Event listener cleanup functions\n *   children: Array<MountResult>    // Child component instances\n * }} cleanup\n *           Object containing cleanup functions and instances\n */\n\n/**\n * @typedef {Object} MountResult\n * @property {HTMLElement} container\n *           The DOM element where the component is mounted\n * @property {ComponentContext} data\n *           The component's reactive state and context data\n * @property {function(): Promise<void>} unmount\n *           Function to clean up and unmount the component\n */\n\n/**\n * @typedef {Object} ElevaPlugin\n * @property {function(Eleva, Record<string, unknown>): void} install\n *           Function that installs the plugin into the Eleva instance\n * @property {string} name\n *           Unique identifier name for the plugin\n */\n\n/**\n * @class ðŸ§© Eleva\n * @classdesc A modern, signal-based component runtime framework that provides lifecycle hooks,\n * scoped styles, and plugin support. Eleva manages component registration, plugin integration,\n * event handling, and DOM rendering with a focus on performance and developer experience.\n *\n * @example\n * // Basic component creation and mounting\n * const app = new Eleva(\"myApp\");\n * app.component(\"myComponent\", {\n *   setup: (ctx) => ({ count: ctx.signal(0) }),\n *   template: (ctx) => `<div>Hello ${ctx.props.name}</div>`\n * });\n * app.mount(document.getElementById(\"app\"), \"myComponent\", { name: \"World\" });\n *\n * @example\n * // Using lifecycle hooks\n * app.component(\"lifecycleDemo\", {\n *   setup: () => {\n *     return {\n *       onMount: ({ container, context }) => {\n *         console.log('Component mounted!');\n *       }\n *     };\n *   },\n *   template: `<div>Lifecycle Demo</div>`\n * });\n */\nexport class Eleva {\n  /**\n   * Creates a new Eleva instance with the specified name and configuration.\n   *\n   * @public\n   * @param {string} name - The unique identifier name for this Eleva instance.\n   * @param {Record<string, unknown>} [config={}] - Optional configuration object for the instance.\n   *        May include framework-wide settings and default behaviors.\n   * @throws {Error} If the name is not provided or is not a string.\n   * @returns {Eleva} A new Eleva instance.\n   *\n   * @example\n   * const app = new Eleva(\"myApp\");\n   * app.component(\"myComponent\", {\n   *   setup: (ctx) => ({ count: ctx.signal(0) }),\n   *   template: (ctx) => `<div>Hello ${ctx.props.name}!</div>`\n   * });\n   * app.mount(document.getElementById(\"app\"), \"myComponent\", { name: \"World\" });\n   *\n   */\n  constructor(name, config = {}) {\n    /** @public {string} The unique identifier name for this Eleva instance */\n    this.name = name;\n    /** @public {Object<string, unknown>} Optional configuration object for the Eleva instance */\n    this.config = config;\n    /** @public {Emitter} Instance of the event emitter for handling component events */\n    this.emitter = new Emitter();\n    /** @public {typeof Signal} Static reference to the Signal class for creating reactive state */\n    this.signal = Signal;\n    /** @public {Renderer} Instance of the renderer for handling DOM updates and patching */\n    this.renderer = new Renderer();\n\n    /** @private {Map<string, ComponentDefinition>} Registry of all component definitions by name */\n    this._components = new Map();\n    /** @private {Map<string, ElevaPlugin>} Collection of installed plugin instances by name */\n    this._plugins = new Map();\n    /** @private {boolean} Flag indicating if the root component is currently mounted */\n    this._isMounted = false;\n  }\n\n  /**\n   * Integrates a plugin with the Eleva framework.\n   * The plugin's install function will be called with the Eleva instance and provided options.\n   * After installation, the plugin will be available for use by components.\n   *\n   * @public\n   * @param {ElevaPlugin} plugin - The plugin object which must have an `install` function.\n   * @param {Object<string, unknown>} [options={}] - Optional configuration options for the plugin.\n   * @returns {Eleva} The Eleva instance (for method chaining).\n   * @example\n   * app.use(myPlugin, { option1: \"value1\" });\n   */\n  use(plugin, options = {}) {\n    plugin.install(this, options);\n    this._plugins.set(plugin.name, plugin);\n\n    return this;\n  }\n\n  /**\n   * Registers a new component with the Eleva instance.\n   * The component will be available for mounting using its registered name.\n   *\n   * @public\n   * @param {string} name - The unique name of the component to register.\n   * @param {ComponentDefinition} definition - The component definition including setup, template, style, and children.\n   * @returns {Eleva} The Eleva instance (for method chaining).\n   * @throws {Error} If the component name is already registered.\n   * @example\n   * app.component(\"myButton\", {\n   *   template: (ctx) => `<button>${ctx.props.text}</button>`,\n   *   style: `button { color: blue; }`\n   * });\n   */\n  component(name, definition) {\n    /** @type {Map<string, ComponentDefinition>} */\n    this._components.set(name, definition);\n    return this;\n  }\n\n  /**\n   * Mounts a registered component to a DOM element.\n   * This will initialize the component, set up its reactive state, and render it to the DOM.\n   *\n   * @public\n   * @param {HTMLElement} container - The DOM element where the component will be mounted.\n   * @param {string|ComponentDefinition} compName - The name of the registered component or a direct component definition.\n   * @param {Object<string, unknown>} [props={}] - Optional properties to pass to the component.\n   * @returns {Promise<MountResult>}\n   *          A Promise that resolves to an object containing:\n   *          - container: The mounted component's container element\n   *          - data: The component's reactive state and context\n   *          - unmount: Function to clean up and unmount the component\n   * @throws {Error} If the container is not found, or component is not registered.\n   * @example\n   * const instance = await app.mount(document.getElementById(\"app\"), \"myComponent\", { text: \"Click me\" });\n   * // Later...\n   * instance.unmount();\n   */\n  async mount(container, compName, props = {}) {\n    if (!container) throw new Error(`Container not found: ${container}`);\n\n    if (container._eleva_instance) return container._eleva_instance;\n\n    /** @type {ComponentDefinition} */\n    const definition =\n      typeof compName === \"string\" ? this._components.get(compName) : compName;\n    if (!definition) throw new Error(`Component \"${compName}\" not registered.`);\n\n    /**\n     * Destructure the component definition to access core functionality.\n     * - setup: Optional function for component initialization and state management\n     * - template: Required function or string that returns the component's HTML structure\n     * - style: Optional function or string for component-scoped CSS styles\n     * - children: Optional object defining nested child components\n     */\n    const { setup, template, style, children } = definition;\n\n    /** @type {ComponentContext} */\n    const context = {\n      props,\n      emitter: this.emitter,\n      /** @type {(v: unknown) => Signal<unknown>} */\n      signal: (v) => new this.signal(v),\n    };\n\n    /**\n     * Processes the mounting of the component.\n     * This function handles:\n     * 1. Merging setup data with the component context\n     * 2. Setting up reactive watchers\n     * 3. Rendering the component\n     * 4. Managing component lifecycle\n     *\n     * @param {Object<string, unknown>} data - Data returned from the component's setup function\n     * @returns {Promise<MountResult>} An object containing:\n     *   - container: The mounted component's container element\n     *   - data: The component's reactive state and context\n     *   - unmount: Function to clean up and unmount the component\n     */\n    const processMount = async (data) => {\n      /** @type {ComponentContext} */\n      const mergedContext = { ...context, ...data };\n      /** @type {Array<() => void>} */\n      const watchers = [];\n      /** @type {Array<MountResult>} */\n      const childInstances = [];\n      /** @type {Array<() => void>} */\n      const listeners = [];\n\n      // Execute before hooks\n      if (!this._isMounted) {\n        /** @type {LifecycleHookContext} */\n        await mergedContext.onBeforeMount?.({\n          container,\n          context: mergedContext,\n        });\n      } else {\n        /** @type {LifecycleHookContext} */\n        await mergedContext.onBeforeUpdate?.({\n          container,\n          context: mergedContext,\n        });\n      }\n\n      /**\n       * Renders the component by:\n       * 1. Processing the template\n       * 2. Updating the DOM\n       * 3. Processing events, injecting styles, and mounting child components.\n       */\n      const render = async () => {\n        const templateResult =\n          typeof template === \"function\"\n            ? await template(mergedContext)\n            : template;\n        const newHtml = TemplateEngine.parse(templateResult, mergedContext);\n        this.renderer.patchDOM(container, newHtml);\n        this._processEvents(container, mergedContext, listeners);\n        if (style)\n          this._injectStyles(container, compName, style, mergedContext);\n        if (children)\n          await this._mountComponents(container, children, childInstances);\n\n        if (!this._isMounted) {\n          /** @type {LifecycleHookContext} */\n          await mergedContext.onMount?.({\n            container,\n            context: mergedContext,\n          });\n          this._isMounted = true;\n        } else {\n          /** @type {LifecycleHookContext} */\n          await mergedContext.onUpdate?.({\n            container,\n            context: mergedContext,\n          });\n        }\n      };\n\n      /**\n       * Sets up reactive watchers for all Signal instances in the component's data.\n       * When a Signal's value changes, the component will re-render to reflect the updates.\n       * Stores unsubscribe functions to clean up watchers when component unmounts.\n       */\n      for (const val of Object.values(data)) {\n        if (val instanceof Signal) watchers.push(val.watch(render));\n      }\n\n      await render();\n\n      const instance = {\n        container,\n        data: mergedContext,\n        /**\n         * Unmounts the component, cleaning up watchers and listeners, child components, and clearing the container.\n         *\n         * @returns {void}\n         */\n        unmount: async () => {\n          /** @type {UnmountHookContext} */\n          await mergedContext.onUnmount?.({\n            container,\n            context: mergedContext,\n            cleanup: {\n              watchers: watchers,\n              listeners: listeners,\n              children: childInstances,\n            },\n          });\n          for (const fn of watchers) fn();\n          for (const fn of listeners) fn();\n          for (const child of childInstances) await child.unmount();\n          container.innerHTML = \"\";\n          delete container._eleva_instance;\n        },\n      };\n\n      container._eleva_instance = instance;\n      return instance;\n    };\n\n    // Handle asynchronous setup.\n    const setupResult = typeof setup === \"function\" ? await setup(context) : {};\n    return await processMount(setupResult);\n  }\n\n  /**\n   * Processes DOM elements for event binding based on attributes starting with \"@\".\n   * This method handles the event delegation system and ensures proper cleanup of event listeners.\n   *\n   * @private\n   * @param {HTMLElement} container - The container element in which to search for event attributes.\n   * @param {ComponentContext} context - The current component context containing event handler definitions.\n   * @param {Array<() => void>} listeners - Array to collect cleanup functions for each event listener.\n   * @returns {void}\n   */\n  _processEvents(container, context, listeners) {\n    /** @type {NodeListOf<Element>} */\n    const elements = container.querySelectorAll(\"*\");\n    for (const el of elements) {\n      /** @type {NamedNodeMap} */\n      const attrs = el.attributes;\n      for (let i = 0; i < attrs.length; i++) {\n        /** @type {Attr} */\n        const attr = attrs[i];\n\n        if (!attr.name.startsWith(\"@\")) continue;\n\n        /** @type {keyof HTMLElementEventMap} */\n        const event = attr.name.slice(1);\n        /** @type {string} */\n        const handlerName = attr.value;\n        /** @type {(event: Event) => void} */\n        const handler =\n          context[handlerName] || TemplateEngine.evaluate(handlerName, context);\n        if (typeof handler === \"function\") {\n          el.addEventListener(event, handler);\n          el.removeAttribute(attr.name);\n          listeners.push(() => el.removeEventListener(event, handler));\n        }\n      }\n    }\n  }\n\n  /**\n   * Injects scoped styles into the component's container.\n   * The styles are automatically prefixed to prevent style leakage to other components.\n   *\n   * @private\n   * @param {HTMLElement} container - The container element where styles should be injected.\n   * @param {string} compName - The component name used to identify the style element.\n   * @param {(function(ComponentContext): string)|string} styleDef - The component's style definition (function or string).\n   * @param {ComponentContext} context - The current component context for style interpolation.\n   * @returns {void}\n   */\n  _injectStyles(container, compName, styleDef, context) {\n    /** @type {string} */\n    const newStyle =\n      typeof styleDef === \"function\"\n        ? TemplateEngine.parse(styleDef(context), context)\n        : styleDef;\n    /** @type {HTMLStyleElement|null} */\n    let styleEl = container.querySelector(`style[data-e-style=\"${compName}\"]`);\n\n    if (styleEl && styleEl.textContent === newStyle) return;\n    if (!styleEl) {\n      styleEl = document.createElement(\"style\");\n      styleEl.setAttribute(\"data-e-style\", compName);\n      container.appendChild(styleEl);\n    }\n\n    styleEl.textContent = newStyle;\n  }\n\n  /**\n   * Extracts props from an element's attributes that start with the specified prefix.\n   * This method is used to collect component properties from DOM elements.\n   *\n   * @private\n   * @param {HTMLElement} element - The DOM element to extract props from\n   * @param {string} prefix - The prefix to look for in attributes\n   * @returns {Record<string, string>} An object containing the extracted props\n   * @example\n   * // For an element with attributes:\n   * // <div :name=\"John\" :age=\"25\">\n   * // Returns: { name: \"John\", age: \"25\" }\n   */\n  _extractProps(element, prefix) {\n    /** @type {Record<string, string>} */\n    const props = {};\n    for (const { name, value } of element.attributes) {\n      if (name.startsWith(prefix)) {\n        props[name.replace(prefix, \"\")] = value;\n      }\n    }\n    return props;\n  }\n\n  /**\n   * Mounts all components within the parent component's container.\n   * This method handles mounting of explicitly defined children components.\n   *\n   * The mounting process follows these steps:\n   * 1. Cleans up any existing component instances\n   * 2. Mounts explicitly defined children components\n   *\n   * @private\n   * @param {HTMLElement} container - The container element to mount components in\n   * @param {Object<string, ComponentDefinition>} children - Map of selectors to component definitions for explicit children\n   * @param {Array<MountResult>} childInstances - Array to store all mounted component instances\n   * @returns {Promise<void>}\n   *\n   * @example\n   * // Explicit children mounting:\n   * const children = {\n   *   'UserProfile': UserProfileComponent,\n   *   '#settings-panel': \"settings-panel\"\n   * };\n   */\n  async _mountComponents(container, children, childInstances) {\n    for (const [selector, component] of Object.entries(children)) {\n      if (!selector) continue;\n      for (const el of container.querySelectorAll(selector)) {\n        if (!(el instanceof HTMLElement)) continue;\n        /** @type {Record<string, string>} */\n        const props = this._extractProps(el, \":\");\n        /** @type {MountResult} */\n        const instance = await this.mount(el, component, props);\n        if (instance && !childInstances.includes(instance)) {\n          childInstances.push(instance);\n        }\n      }\n    }\n  }\n}\n"],"names":["TemplateEngine","expressionPattern","parse","template","data","replace","_","expression","evaluate","Function","Signal","constructor","value","_value","_watchers","Set","_pending","newVal","_notify","watch","fn","add","delete","queueMicrotask","forEach","Emitter","_events","Map","on","event","handler","has","set","get","off","handlers","size","emit","args","CAMEL_RE","Renderer","_tempContainer","document","createElement","patchDOM","container","newHtml","HTMLElement","TypeError","innerHTML","_diff","error","Error","message","oldParent","newParent","isEqualNode","oldChildren","Array","from","childNodes","newChildren","oldStartIdx","newStartIdx","oldEndIdx","length","newEndIdx","oldKeyMap","oldStartNode","newStartNode","_keysMatch","_patchNode","_createKeyMap","newKey","nodeType","Node","ELEMENT_NODE","getAttribute","moveIndex","undefined","oldNodeToMove","insertBefore","cloneNode","refNode","i","node","nodeName","hasAttribute","removeChild","oldNode","newNode","oldKey","_eleva_instance","replaceWith","oldEl","newEl","_updateAttributes","TEXT_NODE","nodeValue","oldAttrs","attributes","newAttrs","name","setAttribute","s","slice","l","toUpperCase","dataset","prop","includes","descriptor","Object","getOwnPropertyDescriptor","getPrototypeOf","isBoolean","call","removeAttribute","children","start","end","map","child","key","Eleva","config","emitter","signal","renderer","_components","_plugins","_isMounted","use","plugin","options","install","component","definition","mount","compName","props","setup","style","context","v","processMount","mergedContext","watchers","childInstances","listeners","onBeforeMount","onBeforeUpdate","render","templateResult","_processEvents","_injectStyles","_mountComponents","onMount","onUpdate","val","values","push","instance","unmount","onUnmount","cleanup","setupResult","elements","querySelectorAll","el","attrs","attr","startsWith","handlerName","addEventListener","removeEventListener","styleDef","newStyle","styleEl","querySelector","textContent","appendChild","_extractProps","element","prefix","selector","entries"],"mappings":"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CAAC,EAAE,EAAE;EACjC,MAAA,MAAMsC,KAAK,GAAGJ,QAAQ,CAAClC,CAAC,CAAC;EACzB,MAAA,IAAIsC,KAAK,EAAEhD,QAAQ,KAAKC,IAAI,CAACC,YAAY,EAAE;EACzC,QAAA,MAAM+C,GAAG,GAAGD,KAAK,CAAC7C,YAAY,CAAC,KAAK,CAAC;UACrC,IAAI8C,GAAG,EAAEF,GAAG,CAACzF,GAAG,CAAC2F,GAAG,EAAEvC,CAAC,CAAC;EAC1B;EACF;EACA,IAAA,OAAOqC,GAAG;EACZ;EACF;;EC7QA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACO,MAAMG,KAAK,CAAC;EACjB;EACF;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACEjH,EAAAA,WAAWA,CAAC2F,IAAI,EAAEuB,MAAM,GAAG,EAAE,EAAE;EAC7B;MACA,IAAI,CAACvB,IAAI,GAAGA,IAAI;EAChB;MACA,IAAI,CAACuB,MAAM,GAAGA,MAAM;EACpB;EACA,IAAA,IAAI,CAACC,OAAO,GAAG,IAAIrG,OAAO,EAAE;EAC5B;MACA,IAAI,CAACsG,MAAM,GAAGrH,MAAM;EACpB;EACA,IAAA,IAAI,CAACsH,QAAQ,GAAG,IAAIxF,QAAQ,EAAE;;EAE9B;EACA,IAAA,I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"}