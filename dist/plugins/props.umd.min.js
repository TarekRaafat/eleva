var t,e;t=this,e=function(t){"use strict";class e{static parse(t,e){return"string"!=typeof t?t:t.replace(this.expressionPattern,(t,n)=>this.evaluate(n,e))}static evaluate(t,e){if("string"!=typeof t)return t;let n=this._functionCache.get(t);if(!n)try{n=Function("data",`with(data) { return ${t}; }`),this._functionCache.set(t,n)}catch{return""}try{return n(e)}catch{return""}}}e.expressionPattern=/\{\{\s*(.*?)\s*\}\}/g,e._functionCache=new Map;let n={name:"props",version:"1.0.0-rc.12",description:"Advanced props data handling for complex data structures with automatic type detection and reactivity",install(t,n={}){let{enableAutoParsing:a=!0,enableReactivity:r=!0,onError:i=null}=n,o=t=>{try{if("string"!=typeof t)return t;if("true"===t)return!0;if("false"===t)return!1;if("null"===t)return null;if("undefined"===t)return;if(t.startsWith("{")||t.startsWith("["))try{return JSON.parse(t)}catch(e){throw Error(`Invalid JSON: ${t}`)}if("1"===t)return!0;if("0"===t)return!1;if(""===t)return!0;if(!isNaN(t)&&""!==t&&!isNaN(parseFloat(t)))return Number(t);if(t.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)){let e=new Date(t);if(!isNaN(e.getTime()))return e}return t}catch(e){return i&&i(e,t),t}},l=e=>{let n={};return Object.entries(e).forEach(([e,a])=>{a&&"object"==typeof a&&"value"in a&&"watch"in a?n[e]=a:n[e]=new t.signal(a)}),n};t._extractProps=t=>{let e={},n=t.attributes;for(let r=n.length-1;r>=0;r--){let i=n[r];if(i.name.startsWith(":")){let n=i.name.slice(1),r=a?o(i.value):i.value;e[n]=r,t.removeAttribute(i.name)}}return e};let s=t.mount;t.mount=async(e,n,a={})=>{let i=r?l(a):a;return await s.call(t,e,n,i)};let c=t._mountComponents,u=new WeakMap,f=new Set;t._mountComponents=async(n,a,i)=>{for(let[e,o]of Object.entries(a))if(e)for(let a of n.querySelectorAll(e)){if(!(a instanceof HTMLElement))continue;let e=t._extractProps(a),s=e,c=u.get(n);if(!c){let t=n;for(;t&&!c;){if(t._eleva_instance&&t._eleva_instance.data){c=t._eleva_instance.data,u.set(n,c);break}t=t.parentElement}}if(r&&c){let n={};Object.keys(e).forEach(e=>{c[e]&&c[e]instanceof t.signal&&(n[e]=c[e])}),s={...e,...n}}let p=s;if(r){let t={};Object.entries(s).forEach(([e,n])=>{n&&"object"==typeof n&&"value"in n&&"watch"in n||(t[e]=n)}),p={...l(t),...s}}let d=await t.mount(a,o,p);d&&!i.includes(d)&&(i.push(d),r&&Object.keys(e).length>0&&!c&&f.add({instance:d,extractedProps:e,container:n,component:o}))}if(r&&f.size>0)for(let n of f){let{instance:a,extractedProps:r,container:i,component:o}=n,l=u.get(i);if(!l){let t=i;for(;t&&!l;){if(t._eleva_instance&&t._eleva_instance.data){l=t._eleva_instance.data,u.set(i,l);break}t=t.parentElement}}if(l){let i={};if(Object.keys(r).forEach(e=>{l[e]&&l[e]instanceof t.signal&&(i[e]=l[e])}),Object.keys(i).length>0){Object.assign(a.data,i);let n=!1,r=t._components.get(o)||o,l=()=>{n||(n=!0,queueMicrotask(()=>{if(n=!1,r&&r.template){let n="function"==typeof r.template?r.template(a.data):r.template,i=e.parse(n,a.data);t.renderer.patchDOM(a.container,i)}}))};if(Object.keys(i).forEach(t=>{let e=i[t];e&&"function"==typeof e.watch&&e.watch(l)}),r&&r.template){let n="function"==typeof r.template?r.template(a.data):r.template,i=e.parse(n,a.data);t.renderer.patchDOM(a.container,i)}}f.delete(n)}}},t.props={parse:t=>a?o(t):t,detectType:t=>null===t?"null":void 0===t?"undefined":"boolean"==typeof t?"boolean":"number"==typeof t?"number":"string"==typeof t?"string":"function"==typeof t?"function":t instanceof Date?"date":t instanceof Map?"map":t instanceof Set?"set":Array.isArray(t)?"array":"object"==typeof t?"object":"unknown"},t._originalExtractProps=t._extractProps,t._originalMount=s,t._originalMountComponents=c},uninstall(t){t._originalExtractProps&&(t._extractProps=t._originalExtractProps,delete t._originalExtractProps),t._originalMount&&(t.mount=t._originalMount,delete t._originalMount),t._originalMountComponents&&(t._mountComponents=t._originalMountComponents,delete t._originalMountComponents),t.props&&delete t.props}};t.Props=n,t.PropsPlugin=n},"object"==typeof exports&&"u">typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="u">typeof globalThis?globalThis:t||self).ElevaPropsPlugin={});
//# sourceMappingURL=props.umd.min.js.map
