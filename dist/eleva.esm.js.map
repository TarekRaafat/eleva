{"version":3,"file":"eleva.esm.js","sources":["../src/modules/TemplateEngine.js","../src/modules/Signal.js","../src/modules/Emitter.js","../src/modules/Renderer.js","../src/core/Eleva.js"],"sourcesContent":["\"use strict\";\n\n/**\n * @class üîí TemplateEngine\n * @classdesc Secure interpolation & dynamic attribute parsing.\n * Provides methods to parse template strings by replacing interpolation expressions\n * with dynamic data values and to evaluate expressions within a given data context.\n */\nexport class TemplateEngine {\n  /**\n   * Parses a template string and replaces interpolation expressions with corresponding values.\n   *\n   * @param {string} template - The template string containing expressions in the format `{{ expression }}`.\n   * @param {Object<string, any>} data - The data object to use for evaluating expressions.\n   * @returns {string} The resulting string with evaluated values.\n   */\n  static parse(template, data) {\n    if (!template || typeof template !== \"string\") return template;\n\n    return template.replace(/\\{\\{\\s*(.*?)\\s*\\}\\}/g, (_, expr) => {\n      return this.evaluate(expr, data);\n    });\n  }\n\n  /**\n   * Evaluates a JavaScript expression using the provided data context.\n   *\n   * @param {string} expr - The JavaScript expression to evaluate.\n   * @param {Object<string, any>} data - The data context for evaluating the expression.\n   * @returns {any} The result of the evaluated expression, or an empty string if undefined or on error.\n   */\n  static evaluate(expr, data) {\n    if (!expr || typeof expr !== \"string\") return expr;\n\n    try {\n      const compiledFn = new Function(\"data\", `with(data) { return ${expr} }`);\n      return compiledFn(data);\n    } catch (error) {\n      console.error(`Template evaluation error:`, {\n        expression: expr,\n        data,\n        error: error.message,\n      });\n      return \"\";\n    }\n  }\n}\n","\"use strict\";\n\n/**\n * @class ‚ö° Signal\n * @classdesc Fine-grained reactivity.\n * A reactive data holder that notifies registered watchers when its value changes,\n * enabling fine-grained DOM patching rather than full re-renders.\n */\nexport class Signal {\n  /**\n   * Creates a new Signal instance.\n   *\n   * @param {*} value - The initial value of the signal.\n   */\n  constructor(value) {\n    /** @private {*} Internal storage for the signal's current value */\n    this._value = value;\n    /** @private {Set<function>} Collection of callback functions to be notified when value changes */\n    this._watchers = new Set();\n    /** @private {boolean} Flag to prevent multiple synchronous watcher notifications and batch updates into microtasks */\n    this._pending = false;\n  }\n\n  /**\n   * Gets the current value of the signal.\n   *\n   * @returns {*} The current value.\n   */\n  get value() {\n    return this._value;\n  }\n\n  /**\n   * Sets a new value for the signal and notifies all registered watchers if the value has changed.\n   *\n   * @param {*} newVal - The new value to set.\n   */\n  set value(newVal) {\n    if (newVal !== this._value) {\n      this._value = newVal;\n      this._notifyWatchers();\n    }\n  }\n\n  /**\n   * Registers a watcher function that will be called whenever the signal's value changes.\n   *\n   * @param {function(any): void} fn - The callback function to invoke on value change.\n   * @returns {function(): boolean} A function to unsubscribe the watcher.\n   */\n  watch(fn) {\n    this._watchers.add(fn);\n    return () => this._watchers.delete(fn);\n  }\n\n  /**\n   * Notifies all registered watchers of a value change using microtask scheduling.\n   * Uses a pending flag to batch multiple synchronous updates into a single notification.\n   * All watcher callbacks receive the current value when executed.\n   *\n   * @private\n   * @returns {void}\n   */\n  _notifyWatchers() {\n    if (!this._pending) {\n      this._pending = true;\n      queueMicrotask(() => {\n        this._pending = false;\n        this._watchers.forEach((fn) => fn(this._value));\n      });\n    }\n  }\n}\n","\"use strict\";\n\n/**\n * @class üéôÔ∏è Emitter\n * @classdesc Robust inter-component communication with event bubbling.\n * Implements a basic publish-subscribe pattern for event handling, allowing components\n * to communicate through custom events.\n */\nexport class Emitter {\n  /**\n   * Creates a new Emitter instance.\n   */\n  constructor() {\n    /** @type {Object.<string, Function[]>} Storage for event handlers mapped by event name */\n    this.events = {};\n  }\n\n  /**\n   * Registers an event handler for the specified event.\n   *\n   * @param {string} event - The name of the event.\n   * @param {function(...any): void} handler - The function to call when the event is emitted.\n   */\n  on(event, handler) {\n    (this.events[event] || (this.events[event] = [])).push(handler);\n  }\n\n  /**\n   * Removes a previously registered event handler.\n   *\n   * @param {string} event - The name of the event.\n   * @param {function(...any): void} handler - The handler function to remove.\n   */\n  off(event, handler) {\n    if (this.events[event]) {\n      this.events[event] = this.events[event].filter((h) => h !== handler);\n    }\n  }\n\n  /**\n   * Emits an event, invoking all handlers registered for that event.\n   *\n   * @param {string} event - The event name.\n   * @param {...any} args - Additional arguments to pass to the event handlers.\n   */\n  emit(event, ...args) {\n    (this.events[event] || []).forEach((handler) => handler(...args));\n  }\n}\n","\"use strict\";\n\n/**\n * @class üé® Renderer\n * @classdesc Handles DOM patching, diffing, and attribute updates.\n * Provides methods for efficient DOM updates by diffing the new and old DOM structures\n * and applying only the necessary changes.\n */\nexport class Renderer {\n  /**\n   * Patches the DOM of a container element with new HTML content.\n   *\n   * @param {HTMLElement} container - The container element to patch.\n   * @param {string} newHtml - The new HTML content to apply.\n   * @throws {Error} If container is not an HTMLElement or newHtml is not a string\n   */\n  patchDOM(container, newHtml) {\n    if (!(container instanceof HTMLElement)) {\n      throw new Error(\"Container must be an HTMLElement\");\n    }\n    if (typeof newHtml !== \"string\") {\n      throw new Error(\"newHtml must be a string\");\n    }\n\n    const temp = document.createElement(\"div\");\n    temp.innerHTML = newHtml;\n    this.diff(container, temp);\n    temp.innerHTML = \"\";\n  }\n\n  /**\n   * Diffs two DOM trees (old and new) and applies updates to the old DOM.\n   *\n   * @param {HTMLElement} oldParent - The original DOM element.\n   * @param {HTMLElement} newParent - The new DOM element.\n   * @throws {Error} If either parent is not an HTMLElement\n   */\n  diff(oldParent, newParent) {\n    if (\n      !(oldParent instanceof HTMLElement) ||\n      !(newParent instanceof HTMLElement)\n    ) {\n      throw new Error(\"Both parents must be HTMLElements\");\n    }\n\n    if (oldParent.isEqualNode(newParent)) return;\n\n    const oldC = oldParent.childNodes;\n    const newC = newParent.childNodes;\n    const len = Math.max(oldC.length, newC.length);\n    const operations = [];\n\n    for (let i = 0; i < len; i++) {\n      const oldNode = oldC[i];\n      const newNode = newC[i];\n\n      if (!oldNode && newNode) {\n        operations.push(() => oldParent.appendChild(newNode.cloneNode(true)));\n        continue;\n      }\n      if (oldNode && !newNode) {\n        operations.push(() => oldParent.removeChild(oldNode));\n        continue;\n      }\n\n      const isSameType =\n        oldNode.nodeType === newNode.nodeType &&\n        oldNode.nodeName === newNode.nodeName;\n\n      if (!isSameType) {\n        operations.push(() =>\n          oldParent.replaceChild(newNode.cloneNode(true), oldNode)\n        );\n        continue;\n      }\n\n      if (oldNode.nodeType === Node.ELEMENT_NODE) {\n        const oldKey = oldNode.getAttribute(\"key\");\n        const newKey = newNode.getAttribute(\"key\");\n\n        if (oldKey !== newKey && (oldKey || newKey)) {\n          operations.push(() =>\n            oldParent.replaceChild(newNode.cloneNode(true), oldNode)\n          );\n          continue;\n        }\n\n        this.updateAttributes(oldNode, newNode);\n        this.diff(oldNode, newNode);\n      } else if (\n        oldNode.nodeType === Node.TEXT_NODE &&\n        oldNode.nodeValue !== newNode.nodeValue\n      ) {\n        oldNode.nodeValue = newNode.nodeValue;\n      }\n    }\n\n    if (operations.length) {\n      operations.forEach((op) => op());\n    }\n  }\n\n  /**\n   * Updates the attributes of an element to match those of a new element.\n   *\n   * @param {HTMLElement} oldEl - The element to update.\n   * @param {HTMLElement} newEl - The element providing the updated attributes.\n   * @throws {Error} If either element is not an HTMLElement\n   */\n  updateAttributes(oldEl, newEl) {\n    if (!(oldEl instanceof HTMLElement) || !(newEl instanceof HTMLElement)) {\n      throw new Error(\"Both elements must be HTMLElements\");\n    }\n\n    const oldAttrs = oldEl.attributes;\n    const newAttrs = newEl.attributes;\n    const operations = [];\n\n    // Remove old attributes\n    for (const { name } of oldAttrs) {\n      if (!name.startsWith(\"@\") && !newEl.hasAttribute(name)) {\n        operations.push(() => oldEl.removeAttribute(name));\n      }\n    }\n\n    // Update/add new attributes\n    for (const attr of newAttrs) {\n      const { name, value } = attr;\n      if (name.startsWith(\"@\")) continue;\n\n      if (oldEl.getAttribute(name) === value) continue;\n\n      operations.push(() => {\n        oldEl.setAttribute(name, value);\n\n        if (name.startsWith(\"aria-\")) {\n          const prop =\n            \"aria\" +\n            name.slice(5).replace(/-([a-z])/g, (_, l) => l.toUpperCase());\n          oldEl[prop] = value;\n        } else if (name.startsWith(\"data-\")) {\n          oldEl.dataset[name.slice(5)] = value;\n        } else {\n          const prop = name.replace(/-([a-z])/g, (_, l) => l.toUpperCase());\n          if (prop in oldEl) {\n            const descriptor = Object.getOwnPropertyDescriptor(\n              Object.getPrototypeOf(oldEl),\n              prop\n            );\n            const isBoolean =\n              typeof oldEl[prop] === \"boolean\" ||\n              (descriptor?.get &&\n                typeof descriptor.get.call(oldEl) === \"boolean\");\n\n            if (isBoolean) {\n              oldEl[prop] =\n                value !== \"false\" &&\n                (value === \"\" || value === prop || value === \"true\");\n            } else {\n              oldEl[prop] = value;\n            }\n          }\n        }\n      });\n    }\n\n    if (operations.length) {\n      operations.forEach((op) => op());\n    }\n  }\n}\n","\"use strict\";\n\nimport { TemplateEngine } from \"../modules/TemplateEngine.js\";\nimport { Signal } from \"../modules/Signal.js\";\nimport { Emitter } from \"../modules/Emitter.js\";\nimport { Renderer } from \"../modules/Renderer.js\";\n\n/**\n * Defines the structure and behavior of a component.\n * @typedef {Object} ComponentDefinition\n * @property {function(Object<string, any>): (Object<string, any>|Promise<Object<string, any>>)} [setup]\n *           Optional setup function that initializes the component's reactive state and lifecycle.\n *           Receives props and context as an argument and should return an object containing the component's state.\n *           Can return either a synchronous object or a Promise that resolves to an object for async initialization.\n *\n * @property {function(Object<string, any>): string} template\n *           Required function that defines the component's HTML structure.\n *           Receives the merged context (props + setup data) and must return an HTML template string.\n *           Supports dynamic expressions using {{ }} syntax for reactive data binding.\n *\n * @property {function(Object<string, any>): string} [style]\n *           Optional function that defines component-scoped CSS styles.\n *           Receives the merged context and returns a CSS string that will be automatically scoped to the component.\n *           Styles are injected into the component's container and only affect elements within it.\n *\n * @property {Object<string, ComponentDefinition>} [children]\n *           Optional object that defines nested child components.\n *           Keys are CSS selectors that match elements in the template where child components should be mounted.\n *           Values are ComponentDefinition objects that define the structure and behavior of each child component.\n */\n\n/**\n * @class üß© Eleva\n * @classdesc Signal-based component runtime framework with lifecycle hooks, scoped styles, and plugin support.\n * Manages component registration, plugin integration, event handling, and DOM rendering.\n */\nexport class Eleva {\n  /**\n   * Creates a new Eleva instance.\n   *\n   * @param {string} name - The name of the Eleva instance.\n   * @param {Object<string, any>} [config={}] - Optional configuration for the instance.\n   */\n  constructor(name, config = {}) {\n    /** @type {string} The unique identifier name for this Eleva instance */\n    this.name = name;\n    /** @type {Object<string, any>} Optional configuration object for the Eleva instance */\n    this.config = config;\n    /** @type {Object<string, ComponentDefinition>} Object storing registered component definitions by name */\n    this._components = {};\n    /** @private {Array<Object>} Collection of installed plugin instances */\n    this._plugins = [];\n    /** @private {string[]} Array of lifecycle hook names supported by the component */\n    this._lifecycleHooks = [\n      \"onBeforeMount\",\n      \"onMount\",\n      \"onBeforeUpdate\",\n      \"onUpdate\",\n      \"onUnmount\",\n    ];\n    /** @private {boolean} Flag indicating if component is currently mounted */\n    this._isMounted = false;\n    /** @private {Emitter} Instance of the event emitter for handling component events */\n    this.emitter = new Emitter();\n    /** @private {Signal} Instance of the signal for handling plugin and component signals */\n    this.signal = Signal;\n    /** @private {Renderer} Instance of the renderer for handling DOM updates and patching */\n    this.renderer = new Renderer();\n  }\n\n  /**\n   * Integrates a plugin with the Eleva framework.\n   *\n   * @param {Object} plugin - The plugin object which should have an `install` function.\n   * @param {Object<string, any>} [options={}] - Optional options to pass to the plugin.\n   * @returns {Eleva} The Eleva instance (for chaining).\n   */\n  use(plugin, options = {}) {\n    if (typeof plugin.install === \"function\") {\n      plugin.install(this, options);\n    }\n    this._plugins.push(plugin);\n    return this;\n  }\n\n  /**\n   * Registers a component with the Eleva instance.\n   *\n   * @param {string} name - The name of the component.\n   * @param {ComponentDefinition} definition - The component definition including setup, template, style, and children.\n   * @returns {Eleva} The Eleva instance (for chaining).\n   */\n  component(name, definition) {\n    this._components[name] = definition;\n    return this;\n  }\n\n  /**\n   * Mounts a registered component to a DOM element.\n   *\n   * @param {HTMLElement} container - A DOM element where the component will be mounted.\n   * @param {string|ComponentDefinition} compName - The name of the component to mount or a component definition.\n   * @param {Object<string, any>} [props={}] - Optional properties to pass to the component.\n   * @returns {object|Promise<object>} An object representing the mounted component instance, or a Promise that resolves to it for asynchronous setups.\n   * @throws {Error} If the container is not found or if the component is not registered.\n   */\n  mount(container, compName, props = {}) {\n    if (!container) throw new Error(`Container not found: ${container}`);\n\n    const definition =\n      typeof compName === \"string\" ? this._components[compName] : compName;\n    if (!definition) throw new Error(`Component \"${compName}\" not registered.`);\n\n    if (typeof definition.template !== \"function\")\n      throw new Error(\"Component template must be a function\");\n\n    /**\n     * Destructure the component definition to access core functionality.\n     * - setup: Optional function for component initialization and state management\n     * - template: Required function that returns the component's HTML structure\n     * - style: Optional function for component-scoped CSS styles\n     * - children: Optional object defining nested child components\n     */\n    const { setup, template, style, children } = definition;\n\n    /**\n     * Creates the initial context object for the component instance.\n     * This context provides core functionality and will be merged with setup data.\n     * @type {Object<string, any>}\n     * @property {Object<string, any>} props - Component properties passed during mounting\n     * @property {Emitter} emitter - Event emitter instance for component event handling\n     * @property {function(any): Signal} signal - Factory function to create reactive Signal instances\n     * @property {Object<string, function(): void>} ...lifecycleHooks - Prepared lifecycle hook functions\n     */\n    const context = {\n      props,\n      emitter: this.emitter,\n      signal: (v) => new this.signal(v),\n      ...this._prepareLifecycleHooks(),\n    };\n\n    /**\n     * Processes the mounting of the component.\n     *\n     * @param {Object<string, any>} data - Data returned from the component's setup function.\n     * @returns {object} An object with the container, merged context data, and an unmount function.\n     */\n    const processMount = (data) => {\n      const mergedContext = { ...context, ...data };\n      const watcherUnsubscribers = [];\n      const childInstances = [];\n      const cleanupListeners = [];\n\n      // Execute before hooks\n      if (!this._isMounted) {\n        mergedContext.onBeforeMount && mergedContext.onBeforeMount();\n      } else {\n        mergedContext.onBeforeUpdate && mergedContext.onBeforeUpdate();\n      }\n\n      /**\n       * Renders the component by parsing the template, patching the DOM,\n       * processing events, injecting styles, and mounting child components.\n       */\n      const render = () => {\n        const newHtml = TemplateEngine.parse(\n          template(mergedContext),\n          mergedContext\n        );\n        this.renderer.patchDOM(container, newHtml);\n        this._processEvents(container, mergedContext, cleanupListeners);\n        this._injectStyles(container, compName, style, mergedContext);\n        this._mountChildren(container, children, childInstances);\n\n        if (!this._isMounted) {\n          mergedContext.onMount && mergedContext.onMount();\n          this._isMounted = true;\n        } else {\n          mergedContext.onUpdate && mergedContext.onUpdate();\n        }\n      };\n\n      /**\n       * Sets up reactive watchers for all Signal instances in the component's data.\n       * When a Signal's value changes, the component will re-render to reflect the updates.\n       * Stores unsubscribe functions to clean up watchers when component unmounts.\n       */\n      Object.values(data).forEach((val) => {\n        if (val instanceof Signal) watcherUnsubscribers.push(val.watch(render));\n      });\n\n      render();\n\n      return {\n        container,\n        data: mergedContext,\n        /**\n         * Unmounts the component, cleaning up watchers and listeners, child components, and clearing the container.\n         *\n         * @returns {void}\n         */\n        unmount: () => {\n          watcherUnsubscribers.forEach((fn) => fn());\n          cleanupListeners.forEach((fn) => fn());\n          childInstances.forEach((child) => child.unmount());\n          mergedContext.onUnmount && mergedContext.onUnmount();\n          container.innerHTML = \"\";\n        },\n      };\n    };\n\n    // Handle asynchronous setup.\n    return Promise.resolve(\n      typeof setup === \"function\" ? setup(context) : {}\n    ).then(processMount);\n  }\n\n  /**\n   * Prepares default no-operation lifecycle hook functions.\n   *\n   * @returns {Object<string, function(): void>} An object with keys for lifecycle hooks mapped to empty functions.\n   * @private\n   */\n  _prepareLifecycleHooks() {\n    return this._lifecycleHooks.reduce((acc, hook) => {\n      acc[hook] = () => {};\n      return acc;\n    }, {});\n  }\n\n  /**\n   * Processes DOM elements for event binding based on attributes starting with \"@\".\n   * Tracks listeners for cleanup during unmount.\n   *\n   * @param {HTMLElement} container - The container element in which to search for events.\n   * @param {Object<string, any>} context - The current context containing event handler definitions.\n   * @param {Array<Function>} cleanupListeners - Array to collect cleanup functions for each event listener.\n   * @private\n   */\n  _processEvents(container, context, cleanupListeners) {\n    const elements = container.querySelectorAll(\"*\");\n    for (const el of elements) {\n      const attrs = el.attributes;\n      for (let i = 0; i < attrs.length; i++) {\n        const attr = attrs[i];\n        if (attr.name.startsWith(\"@\")) {\n          const event = attr.name.slice(1);\n          const handler = TemplateEngine.evaluate(attr.value, context);\n          if (typeof handler === \"function\") {\n            el.addEventListener(event, handler);\n            el.removeAttribute(attr.name);\n            cleanupListeners.push(() => el.removeEventListener(event, handler));\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Injects scoped styles into the component's container.\n   *\n   * @param {HTMLElement} container - The container element.\n   * @param {string} compName - The component name used to identify the style element.\n   * @param {function(Object<string, any>): string} [styleFn] - A function that returns CSS styles as a string.\n   * @param {Object<string, any>} context - The current context for style interpolation.\n   * @private\n   */\n  _injectStyles(container, compName, styleFn, context) {\n    if (!styleFn) return;\n\n    let styleEl = container.querySelector(\n      `style[data-eleva-style=\"${compName}\"]`\n    );\n    if (!styleEl) {\n      styleEl = document.createElement(\"style\");\n      styleEl.setAttribute(\"data-eleva-style\", compName);\n      container.appendChild(styleEl);\n    }\n    styleEl.textContent = TemplateEngine.parse(styleFn(context), context);\n  }\n\n  /**\n   * Mounts child components within the parent component's container.\n   *\n   * @param {HTMLElement} container - The parent container element.\n   * @param {Object<string, ComponentDefinition>} [children] - An object mapping child component selectors to their definitions.\n   * @param {Array<object>} childInstances - An array to store the mounted child component instances.\n   * @private\n   */\n  _mountChildren(container, children, childInstances) {\n    childInstances.forEach((child) => child.unmount());\n    childInstances.length = 0;\n\n    Object.keys(children || {}).forEach((childSelector) => {\n      container.querySelectorAll(childSelector).forEach((childEl) => {\n        const props = {};\n        [...childEl.attributes].forEach(({ name, value }) => {\n          if (name.startsWith(\"eleva-prop-\")) {\n            props[name.replace(\"eleva-prop-\", \"\")] = value;\n          }\n        });\n        const instance = this.mount(childEl, children[childSelector], props);\n        childInstances.push(instance);\n      });\n    });\n  }\n}\n"],"names":["TemplateEngine","parse","template","data","replace","_","expr","evaluate","compiledFn","Function","error","console","expression","message","Signal","constructor","value","_value","_watchers","Set","_pending","newVal","_notifyWatchers","watch","fn","add","delete","queueMicrotask","forEach","Emitter","events","on","event","handler","push","off","filter","h","emit","args","Renderer","patchDOM","container","newHtml","HTMLElement","Error","temp","document","createElement","innerHTML","diff","oldParent","newParent","isEqualNode","oldC","childNodes","newC","len","Math","max","length","operations","i","oldNode","newNode","appendChild","cloneNode","removeChild","isSameType","nodeType","nodeName","replaceChild","Node","ELEMENT_NODE","oldKey","getAttribute","newKey","updateAttributes","TEXT_NODE","nodeValue","op","oldEl","newEl","oldAttrs","attributes","newAttrs","name","startsWith","hasAttribute","removeAttribute","attr","setAttribute","prop","slice","l","toUpperCase","dataset","descriptor","Object","getOwnPropertyDescriptor","getPrototypeOf","isBoolean","get","call","Eleva","config","_components","_plugins","_lifecycleHooks","_isMounted","emitter","signal","renderer","use","plugin","options","install","component","definition","mount","compName","props","setup","style","children","context","v","_prepareLifecycleHooks","processMount","mergedContext","watcherUnsubscribers","childInstances","cleanupListeners","onBeforeMount","onBeforeUpdate","render","_processEvents","_injectStyles","_mountChildren","onMount","onUpdate","values","val","unmount","child","onUnmount","Promise","resolve","then","reduce","acc","hook","elements","querySelectorAll","el","attrs","addEventListener","removeEventListener","styleFn","styleEl","querySelector","textContent","keys","childSelector","childEl","instance"],"mappings":"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"}