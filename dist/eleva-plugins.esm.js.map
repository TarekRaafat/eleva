{"version":3,"file":"eleva-plugins.esm.js","sources":["../src/plugins/Attr.js","../src/plugins/Router.js","../src/modules/TemplateEngine.js","../src/plugins/Props.js","../src/plugins/Store.js"],"sourcesContent":["\"use strict\";\n\n/**\n * A regular expression to match hyphenated lowercase letters.\n * @private\n * @type {RegExp}\n */\nconst CAMEL_RE = /-([a-z])/g;\n\n/**\n * @class ðŸŽ¯ AttrPlugin\n * @classdesc A plugin that provides advanced attribute handling for Eleva components.\n * This plugin extends the renderer with sophisticated attribute processing including:\n * - ARIA attribute handling with proper property mapping\n * - Data attribute management\n * - Boolean attribute processing\n * - Dynamic property detection and mapping\n * - Attribute cleanup and removal\n *\n * @example\n * // Install the plugin\n * const app = new Eleva(\"myApp\");\n * app.use(AttrPlugin);\n *\n * // Use advanced attributes in components\n * app.component(\"myComponent\", {\n *   template: (ctx) => `\n *     <button\n *       aria-expanded=\"${ctx.isExpanded.value}\"\n *       data-user-id=\"${ctx.userId.value}\"\n *       disabled=\"${ctx.isLoading.value}\"\n *       class=\"btn ${ctx.variant.value}\"\n *     >\n *       ${ctx.text.value}\n *     </button>\n *   `\n * });\n */\nexport const AttrPlugin = {\n  /**\n   * Unique identifier for the plugin\n   * @type {string}\n   */\n  name: \"attr\",\n\n  /**\n   * Plugin version\n   * @type {string}\n   */\n  version: \"1.0.0-rc.10\",\n\n  /**\n   * Plugin description\n   * @type {string}\n   */\n  description: \"Advanced attribute handling for Eleva components\",\n\n  /**\n   * Installs the plugin into the Eleva instance\n   *\n   * @param {Object} eleva - The Eleva instance\n   * @param {Object} options - Plugin configuration options\n   * @param {boolean} [options.enableAria=true] - Enable ARIA attribute handling\n   * @param {boolean} [options.enableData=true] - Enable data attribute handling\n   * @param {boolean} [options.enableBoolean=true] - Enable boolean attribute handling\n   * @param {boolean} [options.enableDynamic=true] - Enable dynamic property detection\n   */\n  install(eleva, options = {}) {\n    const {\n      enableAria = true,\n      enableData = true,\n      enableBoolean = true,\n      enableDynamic = true,\n    } = options;\n\n    /**\n     * Updates the attributes of an element to match a new element's attributes.\n     * This method provides sophisticated attribute processing including:\n     * - ARIA attribute handling with proper property mapping\n     * - Data attribute management\n     * - Boolean attribute processing\n     * - Dynamic property detection and mapping\n     * - Attribute cleanup and removal\n     *\n     * @param {HTMLElement} oldEl - The original element to update\n     * @param {HTMLElement} newEl - The new element to update\n     * @returns {void}\n     */\n    const updateAttributes = (oldEl, newEl) => {\n      const oldAttrs = oldEl.attributes;\n      const newAttrs = newEl.attributes;\n\n      // Process new attributes\n      for (let i = 0; i < newAttrs.length; i++) {\n        const { name, value } = newAttrs[i];\n\n        // Skip event attributes (handled by event system)\n        if (name.startsWith(\"@\")) continue;\n\n        // Skip if attribute hasn't changed\n        if (oldEl.getAttribute(name) === value) continue;\n\n        // Handle ARIA attributes\n        if (enableAria && name.startsWith(\"aria-\")) {\n          const prop =\n            \"aria\" + name.slice(5).replace(CAMEL_RE, (_, l) => l.toUpperCase());\n          oldEl[prop] = value;\n          oldEl.setAttribute(name, value);\n        }\n        // Handle data attributes\n        else if (enableData && name.startsWith(\"data-\")) {\n          oldEl.dataset[name.slice(5)] = value;\n          oldEl.setAttribute(name, value);\n        }\n        // Handle other attributes\n        else {\n          let prop = name.replace(CAMEL_RE, (_, l) => l.toUpperCase());\n\n          // Dynamic property detection\n          if (\n            enableDynamic &&\n            !(prop in oldEl) &&\n            !Object.getOwnPropertyDescriptor(Object.getPrototypeOf(oldEl), prop)\n          ) {\n            const elementProps = Object.getOwnPropertyNames(\n              Object.getPrototypeOf(oldEl)\n            );\n            const matchingProp = elementProps.find(\n              (p) =>\n                p.toLowerCase() === name.toLowerCase() ||\n                p.toLowerCase().includes(name.toLowerCase()) ||\n                name.toLowerCase().includes(p.toLowerCase())\n            );\n\n            if (matchingProp) {\n              prop = matchingProp;\n            }\n          }\n\n          const descriptor = Object.getOwnPropertyDescriptor(\n            Object.getPrototypeOf(oldEl),\n            prop\n          );\n          const hasProperty = prop in oldEl || descriptor;\n\n          if (hasProperty) {\n            // Boolean attribute handling\n            if (enableBoolean) {\n              const isBoolean =\n                typeof oldEl[prop] === \"boolean\" ||\n                (descriptor?.get &&\n                  typeof descriptor.get.call(oldEl) === \"boolean\");\n\n              if (isBoolean) {\n                const boolValue =\n                  value !== \"false\" &&\n                  (value === \"\" || value === prop || value === \"true\");\n                oldEl[prop] = boolValue;\n\n                if (boolValue) {\n                  oldEl.setAttribute(name, \"\");\n                } else {\n                  oldEl.removeAttribute(name);\n                }\n              } else {\n                oldEl[prop] = value;\n                oldEl.setAttribute(name, value);\n              }\n            } else {\n              oldEl[prop] = value;\n              oldEl.setAttribute(name, value);\n            }\n          } else {\n            oldEl.setAttribute(name, value);\n          }\n        }\n      }\n\n      // Remove old attributes that are no longer present\n      for (let i = oldAttrs.length - 1; i >= 0; i--) {\n        const name = oldAttrs[i].name;\n        if (!newEl.hasAttribute(name)) {\n          oldEl.removeAttribute(name);\n        }\n      }\n    };\n\n    // Extend the renderer with the advanced attribute handler\n    if (eleva.renderer) {\n      eleva.renderer.updateAttributes = updateAttributes;\n\n      // Store the original _patchNode method\n      const originalPatchNode = eleva.renderer._patchNode;\n      eleva.renderer._originalPatchNode = originalPatchNode;\n\n      // Override the _patchNode method to use our attribute handler\n      eleva.renderer._patchNode = function (oldNode, newNode) {\n        if (oldNode?._eleva_instance) return;\n\n        if (!this._isSameNode(oldNode, newNode)) {\n          oldNode.replaceWith(newNode.cloneNode(true));\n          return;\n        }\n\n        if (oldNode.nodeType === Node.ELEMENT_NODE) {\n          updateAttributes(oldNode, newNode);\n          this._diff(oldNode, newNode);\n        } else if (\n          oldNode.nodeType === Node.TEXT_NODE &&\n          oldNode.nodeValue !== newNode.nodeValue\n        ) {\n          oldNode.nodeValue = newNode.nodeValue;\n        }\n      };\n    }\n\n    // Add plugin metadata to the Eleva instance\n    if (!eleva.plugins) {\n      eleva.plugins = new Map();\n    }\n    eleva.plugins.set(this.name, {\n      name: this.name,\n      version: this.version,\n      description: this.description,\n      options,\n    });\n\n    // Add utility methods for manual attribute updates\n    eleva.updateElementAttributes = updateAttributes;\n  },\n\n  /**\n   * Uninstalls the plugin from the Eleva instance\n   *\n   * @param {Object} eleva - The Eleva instance\n   */\n  uninstall(eleva) {\n    // Restore original _patchNode method if it exists\n    if (eleva.renderer && eleva.renderer._originalPatchNode) {\n      eleva.renderer._patchNode = eleva.renderer._originalPatchNode;\n      delete eleva.renderer._originalPatchNode;\n    }\n\n    // Remove plugin metadata\n    if (eleva.plugins) {\n      eleva.plugins.delete(this.name);\n    }\n\n    // Remove utility methods\n    delete eleva.updateElementAttributes;\n  },\n};\n","\"use strict\";\n\n/**\n * @typedef {import('eleva').Eleva} Eleva\n * @typedef {import('eleva').Signal} Signal\n * @typedef {import('eleva').ComponentDefinition} ComponentDefinition\n * @typedef {import('eleva').Emitter} Emitter\n * @typedef {import('eleva').MountResult} MountResult\n */\n\n// ============================================\n// Core Type Definitions\n// ============================================\n\n/**\n * @typedef {'hash' | 'history' | 'query'} RouterMode\n * The routing mode determines how the router manages URL state.\n * - `hash`: Uses URL hash (e.g., `/#/path`) - works without server config\n * - `history`: Uses HTML5 History API (e.g., `/path`) - requires server config\n * - `query`: Uses query parameters (e.g., `?view=/path`) - useful for embedded apps\n */\n\n/**\n * @typedef {Object} RouterOptions\n * @property {RouterMode} [mode='hash'] - The routing mode to use.\n * @property {string} [queryParam='view'] - Query parameter name for 'query' mode.\n * @property {string} [viewSelector='root'] - Selector for the view container element.\n * @property {string} mount - CSS selector for the mount point element.\n * @property {RouteDefinition[]} routes - Array of route definitions.\n * @property {string | ComponentDefinition} [globalLayout] - Default layout for all routes.\n * @property {NavigationGuard} [onBeforeEach] - Global navigation guard.\n * @description Configuration options for the Router plugin.\n */\n\n/**\n * @typedef {Object} NavigationTarget\n * @property {string} path - The target path (can include params like '/users/:id').\n * @property {Record<string, string>} [params] - Route parameters to inject into the path.\n * @property {Record<string, string>} [query] - Query parameters to append.\n * @property {boolean} [replace=false] - Whether to replace current history entry.\n * @property {Record<string, any>} [state] - State object to pass to history.\n * @description Object describing a navigation target for `router.navigate()`.\n */\n\n/**\n * @typedef {Object} ScrollPosition\n * @property {number} x - Horizontal scroll position.\n * @property {number} y - Vertical scroll position.\n * @description Represents a saved scroll position.\n */\n\n/**\n * @typedef {Object} RouteSegment\n * @property {'static' | 'param'} type - The segment type.\n * @property {string} value - The segment value (for static) or empty string (for param).\n * @property {string} [name] - The parameter name (for param segments).\n * @description Internal representation of a parsed route path segment.\n * @private\n */\n\n/**\n * @typedef {Object} RouteMatch\n * @property {RouteDefinition} route - The matched route definition.\n * @property {Record<string, string>} params - The extracted route parameters.\n * @description Result of matching a path against route definitions.\n * @private\n */\n\n/**\n * @typedef {Record<string, any>} RouteMeta\n * @description Arbitrary metadata attached to routes for use in guards and components.\n * Common properties include:\n * - `requiresAuth: boolean` - Whether the route requires authentication\n * - `title: string` - Page title for the route\n * - `roles: string[]` - Required user roles\n * @example\n * {\n *   path: '/admin',\n *   component: AdminPage,\n *   meta: { requiresAuth: true, roles: ['admin'], title: 'Admin Dashboard' }\n * }\n */\n\n/**\n * @typedef {Object} RouterErrorHandler\n * @property {(error: Error, context: string, details?: Record<string, any>) => void} handle - Throws a formatted error.\n * @property {(message: string, details?: Record<string, any>) => void} warn - Logs a warning.\n * @property {(message: string, error: Error, details?: Record<string, any>) => void} log - Logs an error without throwing.\n * @description Interface for the router's error handling system.\n */\n\n// ============================================\n// Event Callback Type Definitions\n// ============================================\n\n/**\n * @callback NavigationContextCallback\n * @param {NavigationContext} context - The navigation context (can be modified to block/redirect).\n * @returns {void | Promise<void>}\n * @description Callback for `router:beforeEach` event. Modify context to control navigation.\n */\n\n/**\n * @callback ResolveContextCallback\n * @param {ResolveContext} context - The resolve context (can be modified to block/redirect).\n * @returns {void | Promise<void>}\n * @description Callback for `router:beforeResolve` and `router:afterResolve` events.\n */\n\n/**\n * @callback RenderContextCallback\n * @param {RenderContext} context - The render context.\n * @returns {void | Promise<void>}\n * @description Callback for `router:beforeRender` and `router:afterRender` events.\n */\n\n/**\n * @callback ScrollContextCallback\n * @param {ScrollContext} context - The scroll context with saved position info.\n * @returns {void | Promise<void>}\n * @description Callback for `router:scroll` event. Use to implement scroll behavior.\n */\n\n/**\n * @callback RouteChangeCallback\n * @param {RouteLocation} to - The target route location.\n * @param {RouteLocation | null} from - The source route location.\n * @returns {void | Promise<void>}\n * @description Callback for `router:afterEnter`, `router:afterLeave`, `router:afterEach` events.\n */\n\n/**\n * @callback RouterErrorCallback\n * @param {Error} error - The error that occurred.\n * @param {RouteLocation} [to] - The target route (if available).\n * @param {RouteLocation | null} [from] - The source route (if available).\n * @returns {void | Promise<void>}\n * @description Callback for `router:onError` event.\n */\n\n/**\n * @callback RouterReadyCallback\n * @param {Router} router - The router instance.\n * @returns {void | Promise<void>}\n * @description Callback for `router:ready` event.\n */\n\n/**\n * @callback RouteAddedCallback\n * @param {RouteDefinition} route - The added route definition.\n * @returns {void | Promise<void>}\n * @description Callback for `router:routeAdded` event.\n */\n\n/**\n * @callback RouteRemovedCallback\n * @param {RouteDefinition} route - The removed route definition.\n * @returns {void | Promise<void>}\n * @description Callback for `router:routeRemoved` event.\n */\n\n// ============================================\n// Core Type Definitions (continued)\n// ============================================\n\n/**\n * Simple error handler for the core router.\n * Can be overridden by error handling plugins.\n * Provides consistent error formatting and logging for router operations.\n * @private\n */\nconst CoreErrorHandler = {\n  /**\n   * Handles router errors with basic formatting.\n   * @param {Error} error - The error to handle.\n   * @param {string} context - The context where the error occurred.\n   * @param {Object} details - Additional error details.\n   * @throws {Error} The formatted error.\n   */\n  handle(error, context, details = {}) {\n    const message = `[ElevaRouter] ${context}: ${error.message}`;\n    const formattedError = new Error(message);\n\n    // Preserve original error details\n    formattedError.originalError = error;\n    formattedError.context = context;\n    formattedError.details = details;\n\n    console.error(message, { error, context, details });\n    throw formattedError;\n  },\n\n  /**\n   * Logs a warning without throwing an error.\n   * @param {string} message - The warning message.\n   * @param {Object} details - Additional warning details.\n   */\n  warn(message, details = {}) {\n    console.warn(`[ElevaRouter] ${message}`, details);\n  },\n\n  /**\n   * Logs an error without throwing.\n   * @param {string} message - The error message.\n   * @param {Error} error - The original error.\n   * @param {Object} details - Additional error details.\n   */\n  log(message, error, details = {}) {\n    console.error(`[ElevaRouter] ${message}`, { error, details });\n  },\n};\n\n/**\n * @typedef {Object} RouteLocation\n * @property {string} path - The path of the route (e.g., '/users/123').\n * @property {Record<string, string>} query - Query parameters as key-value pairs.\n * @property {string} fullUrl - The complete URL including hash, path, and query string.\n * @property {Record<string, string>} params - Dynamic route parameters (e.g., `{ id: '123' }`).\n * @property {RouteMeta} meta - Metadata associated with the matched route.\n * @property {string} [name] - The optional name of the matched route.\n * @property {RouteDefinition} matched - The raw route definition object that was matched.\n * @description Represents the current or target location in the router.\n */\n\n/**\n * @typedef {boolean | string | NavigationTarget | void} NavigationGuardResult\n * The return value of a navigation guard.\n * - `true` or `undefined/void`: Allow navigation\n * - `false`: Abort navigation\n * - `string`: Redirect to path\n * - `NavigationTarget`: Redirect with options\n */\n\n/**\n * @callback NavigationGuard\n * @param {RouteLocation} to - The target route location.\n * @param {RouteLocation | null} from - The source route location (null on initial navigation).\n * @returns {NavigationGuardResult | Promise<NavigationGuardResult>}\n * @description A function that controls navigation flow. Runs before navigation is confirmed.\n * @example\n * // Simple auth guard\n * const authGuard = (to, from) => {\n *   if (to.meta.requiresAuth && !isLoggedIn()) {\n *     return '/login'; // Redirect\n *   }\n *   // Allow navigation (implicit return undefined)\n * };\n */\n\n/**\n * @callback NavigationHook\n * @param {RouteLocation} to - The target route location.\n * @param {RouteLocation | null} from - The source route location.\n * @returns {void | Promise<void>}\n * @description A lifecycle hook for side effects. Does not affect navigation flow.\n * @example\n * // Analytics hook\n * const analyticsHook = (to, from) => {\n *   analytics.trackPageView(to.path);\n * };\n */\n\n/**\n * @typedef {Object} RouterPlugin\n * @property {string} name - Unique plugin identifier.\n * @property {string} [version] - Plugin version (recommended to match router version).\n * @property {(router: Router, options?: Record<string, any>) => void} install - Installation function.\n * @property {(router: Router) => void | Promise<void>} [destroy] - Cleanup function called on router.destroy().\n * @description Interface for router plugins. Plugins can extend router functionality.\n * @example\n * const AnalyticsPlugin = {\n *   name: 'analytics',\n *   version: '1.0.0',\n *   install(router, options) {\n *     router.emitter.on('router:afterEach', (to, from) => {\n *       analytics.track(to.path);\n *     });\n *   }\n * };\n */\n\n/**\n * @typedef {Object} NavigationContext\n * @property {RouteLocation} to - The target route location.\n * @property {RouteLocation | null} from - The source route location.\n * @property {boolean} cancelled - Whether navigation has been cancelled.\n * @property {string | {path: string} | null} redirectTo - Redirect target if navigation should redirect.\n * @description A context object passed to navigation events that plugins can modify to control navigation flow.\n */\n\n/**\n * @typedef {Object} ResolveContext\n * @property {RouteLocation} to - The target route location.\n * @property {RouteLocation | null} from - The source route location.\n * @property {RouteDefinition} route - The matched route definition.\n * @property {ComponentDefinition | null} layoutComponent - The resolved layout component (available in afterResolve).\n * @property {ComponentDefinition | null} pageComponent - The resolved page component (available in afterResolve).\n * @property {boolean} cancelled - Whether navigation has been cancelled.\n * @property {string | {path: string} | null} redirectTo - Redirect target if navigation should redirect.\n * @description A context object passed to component resolution events.\n */\n\n/**\n * @typedef {Object} RenderContext\n * @property {RouteLocation} to - The target route location.\n * @property {RouteLocation | null} from - The source route location.\n * @property {ComponentDefinition | null} layoutComponent - The layout component being rendered.\n * @property {ComponentDefinition} pageComponent - The page component being rendered.\n * @description A context object passed to render events.\n */\n\n/**\n * @typedef {Object} ScrollContext\n * @property {RouteLocation} to - The target route location.\n * @property {RouteLocation | null} from - The source route location.\n * @property {{x: number, y: number} | null} savedPosition - The saved scroll position (if navigating via back/forward).\n * @description A context object passed to scroll events for plugins to handle scroll behavior.\n */\n\n/**\n * @typedef {string | ComponentDefinition | (() => Promise<{default: ComponentDefinition}>)} RouteComponent\n * A component that can be rendered for a route.\n * - `string`: Name of a registered component\n * - `ComponentDefinition`: Inline component definition\n * - `() => Promise<{default: ComponentDefinition}>`: Lazy-loaded component (e.g., `() => import('./Page.js')`)\n */\n\n/**\n * @typedef {Object} RouteDefinition\n * @property {string} path - URL path pattern. Supports:\n *   - Static: `'/about'`\n *   - Dynamic params: `'/users/:id'`\n *   - Wildcard: `'*'` (catch-all, must be last)\n * @property {RouteComponent} component - The component to render for this route.\n * @property {RouteComponent} [layout] - Optional layout component to wrap the route component.\n * @property {string} [name] - Optional route name for programmatic navigation.\n * @property {RouteMeta} [meta] - Optional metadata (auth flags, titles, etc.).\n * @property {NavigationGuard} [beforeEnter] - Route-specific guard before entering.\n * @property {NavigationHook} [afterEnter] - Hook after entering and component is mounted.\n * @property {NavigationGuard} [beforeLeave] - Guard before leaving this route.\n * @property {NavigationHook} [afterLeave] - Hook after leaving and component is unmounted.\n * @property {RouteSegment[]} [segments] - Internal: parsed path segments (added by router).\n * @description Defines a route in the application.\n * @example\n * // Static route\n * { path: '/about', component: AboutPage }\n *\n * // Dynamic route with params\n * { path: '/users/:id', component: UserPage, meta: { requiresAuth: true } }\n *\n * // Lazy-loaded route with layout\n * {\n *   path: '/dashboard',\n *   component: () => import('./Dashboard.js'),\n *   layout: DashboardLayout,\n *   beforeEnter: (to, from) => isLoggedIn() || '/login'\n * }\n *\n * // Catch-all 404 route (must be last)\n * { path: '*', component: NotFoundPage }\n */\n\n/**\n * @class Router\n * @classdesc A powerful, reactive, and flexible Router Plugin for Eleva.js.\n * This class manages all routing logic, including state, navigation, and rendering.\n *\n * ## Features\n * - Multiple routing modes (hash, history, query)\n * - Reactive route state via Signals\n * - Navigation guards and lifecycle hooks\n * - Lazy-loaded components\n * - Layout system\n * - Plugin architecture\n * - Scroll position management\n *\n * ## Events Reference\n * | Event | Callback Type | Can Block | Description |\n * |-------|--------------|-----------|-------------|\n * | `router:ready` | {@link RouterReadyCallback} | No | Router initialized |\n * | `router:beforeEach` | {@link NavigationContextCallback} | Yes | Before guards run |\n * | `router:beforeResolve` | {@link ResolveContextCallback} | Yes | Before component loading |\n * | `router:afterResolve` | {@link ResolveContextCallback} | No | After components loaded |\n * | `router:afterLeave` | {@link RouteChangeCallback} | No | After leaving route |\n * | `router:beforeRender` | {@link RenderContextCallback} | No | Before DOM update |\n * | `router:afterRender` | {@link RenderContextCallback} | No | After DOM update |\n * | `router:scroll` | {@link ScrollContextCallback} | No | For scroll behavior |\n * | `router:afterEnter` | {@link RouteChangeCallback} | No | After entering route |\n * | `router:afterEach` | {@link RouteChangeCallback} | No | Navigation complete |\n * | `router:onError` | {@link RouterErrorCallback} | No | Navigation error |\n * | `router:routeAdded` | {@link RouteAddedCallback} | No | Dynamic route added |\n * | `router:routeRemoved` | {@link RouteRemovedCallback} | No | Dynamic route removed |\n *\n * ## Reactive Signals\n * - `currentRoute: Signal<RouteLocation | null>` - Current route info\n * - `previousRoute: Signal<RouteLocation | null>` - Previous route info\n * - `currentParams: Signal<Record<string, string>>` - Current route params\n * - `currentQuery: Signal<Record<string, string>>` - Current query params\n * - `currentLayout: Signal<MountResult | null>` - Mounted layout instance\n * - `currentView: Signal<MountResult | null>` - Mounted view instance\n * - `isReady: Signal<boolean>` - Router readiness state\n *\n * @note Internal API Access Policy:\n * As a core Eleva plugin, the Router may access internal Eleva APIs (prefixed with _)\n * such as `eleva._components`. This is intentional and these internal APIs are\n * considered stable for official plugins. Third-party plugins should avoid\n * accessing internal APIs as they may change without notice.\n *\n * @example\n * // Basic setup\n * const router = new Router(eleva, {\n *   mode: 'hash',\n *   mount: '#app',\n *   routes: [\n *     { path: '/', component: HomePage },\n *     { path: '/users/:id', component: UserPage },\n *     { path: '*', component: NotFoundPage }\n *   ]\n * });\n *\n * // Start router\n * await router.start();\n *\n * // Navigate programmatically\n * const success = await router.navigate('/users/123');\n *\n * // Watch for route changes\n * router.currentRoute.watch((route) => {\n *   document.title = route?.meta?.title || 'My App';\n * });\n *\n * @private\n */\nclass Router {\n  /**\n   * Creates an instance of the Router.\n   * @param {Eleva} eleva - The Eleva framework instance.\n   * @param {RouterOptions} options - The configuration options for the router.\n   */\n  constructor(eleva, options = {}) {\n    /** @type {Eleva} The Eleva framework instance. */\n    this.eleva = eleva;\n\n    /** @type {RouterOptions} The merged router options. */\n    this.options = {\n      mode: \"hash\",\n      queryParam: \"view\",\n      viewSelector: \"root\",\n      ...options,\n    };\n\n    /** @private @type {RouteDefinition[]} The processed list of route definitions. */\n    this.routes = this._processRoutes(options.routes || []);\n\n    /** @private @type {import('eleva').Emitter} The shared Eleva event emitter for global hooks. */\n    this.emitter = this.eleva.emitter;\n\n    /** @private @type {boolean} A flag indicating if the router has been started. */\n    this.isStarted = false;\n\n    /** @private @type {boolean} A flag to prevent navigation loops from history events. */\n    this._isNavigating = false;\n\n    /** @private @type {number} Counter for tracking navigation operations to prevent race conditions. */\n    this._navigationId = 0;\n\n    /** @private @type {Array<() => void>} A collection of cleanup functions for event listeners. */\n    this.eventListeners = [];\n\n    /** @type {Signal<RouteLocation | null>} A reactive signal holding the current route's information. */\n    this.currentRoute = new this.eleva.signal(null);\n\n    /** @type {Signal<RouteLocation | null>} A reactive signal holding the previous route's information. */\n    this.previousRoute = new this.eleva.signal(null);\n\n    /** @type {Signal<Object<string, string>>} A reactive signal holding the current route's parameters. */\n    this.currentParams = new this.eleva.signal({});\n\n    /** @type {Signal<Object<string, string>>} A reactive signal holding the current route's query parameters. */\n    this.currentQuery = new this.eleva.signal({});\n\n    /** @type {Signal<import('eleva').MountResult | null>} A reactive signal for the currently mounted layout instance. */\n    this.currentLayout = new this.eleva.signal(null);\n\n    /** @type {Signal<import('eleva').MountResult | null>} A reactive signal for the currently mounted view (page) instance. */\n    this.currentView = new this.eleva.signal(null);\n\n    /** @type {Signal<boolean>} A reactive signal indicating if the router is ready (started and initial navigation complete). */\n    this.isReady = new this.eleva.signal(false);\n\n    /** @private @type {Map<string, RouterPlugin>} Map of registered plugins by name. */\n    this.plugins = new Map();\n\n    /** @private @type {Array<NavigationGuard>} Array of global before-each navigation guards. */\n    this._beforeEachGuards = [];\n\n    // If onBeforeEach was provided in options, add it to the guards array\n    if (options.onBeforeEach) {\n      this._beforeEachGuards.push(options.onBeforeEach);\n    }\n\n    /** @type {Object} The error handler instance. Can be overridden by plugins. */\n    this.errorHandler = CoreErrorHandler;\n\n    /** @private @type {Map<string, {x: number, y: number}>} Saved scroll positions by route path. */\n    this._scrollPositions = new Map();\n\n    this._validateOptions();\n  }\n\n  /**\n   * Validates the provided router options.\n   * @private\n   * @throws {Error} If the routing mode is invalid.\n   */\n  _validateOptions() {\n    if (![\"hash\", \"query\", \"history\"].includes(this.options.mode)) {\n      this.errorHandler.handle(\n        new Error(\n          `Invalid routing mode: ${this.options.mode}. Must be \"hash\", \"query\", or \"history\".`\n        ),\n        \"Configuration validation failed\"\n      );\n    }\n  }\n\n  /**\n   * Pre-processes route definitions to parse their path segments for efficient matching.\n   * @private\n   * @param {RouteDefinition[]} routes - The raw route definitions.\n   * @returns {RouteDefinition[]} The processed routes.\n   */\n  _processRoutes(routes) {\n    const processedRoutes = [];\n    for (const route of routes) {\n      try {\n        processedRoutes.push({\n          ...route,\n          segments: this._parsePathIntoSegments(route.path),\n        });\n      } catch (error) {\n        this.errorHandler.warn(\n          `Invalid path in route definition \"${route.path || \"undefined\"}\": ${error.message}`,\n          { route, error }\n        );\n      }\n    }\n    return processedRoutes;\n  }\n\n  /**\n   * Parses a route path string into an array of static and parameter segments.\n   * @private\n   * @param {string} path - The path pattern to parse.\n   * @returns {Array<{type: 'static' | 'param', value?: string, name?: string}>} An array of segment objects.\n   * @throws {Error} If the route path is not a valid string.\n   */\n  _parsePathIntoSegments(path) {\n    if (!path || typeof path !== \"string\") {\n      this.errorHandler.handle(\n        new Error(\"Route path must be a non-empty string\"),\n        \"Path parsing failed\",\n        { path }\n      );\n    }\n\n    const normalizedPath = path.replace(/\\/+/g, \"/\").replace(/\\/$/, \"\") || \"/\";\n\n    if (normalizedPath === \"/\") {\n      return [];\n    }\n\n    return normalizedPath\n      .split(\"/\")\n      .filter(Boolean)\n      .map((segment) => {\n        if (segment.startsWith(\":\")) {\n          const paramName = segment.substring(1);\n          if (!paramName) {\n            this.errorHandler.handle(\n              new Error(`Invalid parameter segment: ${segment}`),\n              \"Path parsing failed\",\n              { segment, path }\n            );\n          }\n          return { type: \"param\", name: paramName };\n        }\n        return { type: \"static\", value: segment };\n      });\n  }\n\n  /**\n   * Finds the view element within a container using multiple selector strategies.\n   * @private\n   * @param {HTMLElement} container - The parent element to search within.\n   * @returns {HTMLElement} The found view element or the container itself as a fallback.\n   */\n  _findViewElement(container) {\n    const selector = this.options.viewSelector;\n    return (\n      container.querySelector(`#${selector}`) ||\n      container.querySelector(`.${selector}`) ||\n      container.querySelector(`[data-${selector}]`) ||\n      container.querySelector(selector) ||\n      container\n    );\n  }\n\n  /**\n   * Starts the router, initializes event listeners, and performs the initial navigation.\n   * @returns {Promise<Router>} The router instance for method chaining.\n   *\n   * @example\n   * // Basic usage\n   * await router.start();\n   *\n   * // Method chaining\n   * await router.start().then(r => r.navigate('/home'));\n   *\n   * // Reactive readiness\n   * router.isReady.watch((ready) => {\n   *   if (ready) console.log('Router is ready!');\n   * });\n   */\n  async start() {\n    if (this.isStarted) {\n      this.errorHandler.warn(\"Router is already started\");\n      return this;\n    }\n    if (typeof window === \"undefined\") {\n      this.errorHandler.warn(\n        \"Router start skipped: `window` object not available (SSR environment)\"\n      );\n      return this;\n    }\n    if (\n      typeof document !== \"undefined\" &&\n      !document.querySelector(this.options.mount)\n    ) {\n      this.errorHandler.warn(\n        `Mount element \"${this.options.mount}\" was not found in the DOM. The router will not start.`,\n        { mountSelector: this.options.mount }\n      );\n      return this;\n    }\n    const handler = () => this._handleRouteChange();\n    if (this.options.mode === \"hash\") {\n      window.addEventListener(\"hashchange\", handler);\n      this.eventListeners.push(() =>\n        window.removeEventListener(\"hashchange\", handler)\n      );\n    } else {\n      window.addEventListener(\"popstate\", handler);\n      this.eventListeners.push(() =>\n        window.removeEventListener(\"popstate\", handler)\n      );\n    }\n    this.isStarted = true;\n    // Initial navigation is not a popstate event\n    await this._handleRouteChange(false);\n    // Set isReady to true after initial navigation completes\n    this.isReady.value = true;\n    await this.emitter.emit(\"router:ready\", this);\n    return this;\n  }\n\n  /**\n   * Stops the router and cleans up all event listeners and mounted components.\n   * @returns {Promise<void>}\n   */\n  async destroy() {\n    if (!this.isStarted) return;\n\n    // Clean up plugins\n    for (const plugin of this.plugins.values()) {\n      if (typeof plugin.destroy === \"function\") {\n        try {\n          await plugin.destroy(this);\n        } catch (error) {\n          this.errorHandler.log(`Plugin ${plugin.name} destroy failed`, error);\n        }\n      }\n    }\n\n    this.eventListeners.forEach((cleanup) => cleanup());\n    this.eventListeners = [];\n    if (this.currentLayout.value) {\n      await this.currentLayout.value.unmount();\n    }\n    this.isStarted = false;\n    this.isReady.value = false;\n  }\n\n  /**\n   * Alias for destroy(). Stops the router and cleans up all resources.\n   * Provided for semantic consistency (start/stop pattern).\n   * @returns {Promise<void>}\n   *\n   * @example\n   * await router.start();\n   * // ... later\n   * await router.stop();\n   */\n  async stop() {\n    return this.destroy();\n  }\n\n  /**\n   * Programmatically navigates to a new route.\n   * @param {string | NavigationTarget} location - The target location as a path string or navigation target object.\n   * @param {Record<string, string>} [params] - Route parameters (only used when location is a string).\n   * @returns {Promise<boolean>} True if navigation succeeded, false if blocked by guards or failed.\n   *\n   * @example\n   * // Basic navigation\n   * await router.navigate('/users/123');\n   *\n   * // Check if navigation succeeded\n   * const success = await router.navigate('/protected');\n   * if (!success) {\n   *   console.log('Navigation was blocked by a guard');\n   * }\n   *\n   * // Navigate with options\n   * await router.navigate({\n   *   path: '/users/:id',\n   *   params: { id: '123' },\n   *   query: { tab: 'profile' },\n   *   replace: true\n   * });\n   */\n  async navigate(location, params = {}) {\n    try {\n      const target =\n        typeof location === \"string\" ? { path: location, params } : location;\n      let path = this._buildPath(target.path, target.params || {});\n      const query = target.query || {};\n\n      if (Object.keys(query).length > 0) {\n        const queryString = new URLSearchParams(query).toString();\n        if (queryString) path += `?${queryString}`;\n      }\n\n      if (this._isSameRoute(path, target.params, query)) {\n        return true; // Already at this route, consider it successful\n      }\n\n      const navigationSuccessful = await this._proceedWithNavigation(path);\n\n      if (navigationSuccessful) {\n        // Increment navigation ID and capture it for this navigation\n        const currentNavId = ++this._navigationId;\n        this._isNavigating = true;\n\n        const state = target.state || {};\n        const replace = target.replace || false;\n        const historyMethod = replace ? \"replaceState\" : \"pushState\";\n\n        if (this.options.mode === \"hash\") {\n          if (replace) {\n            const newUrl = `${window.location.pathname}${window.location.search}#${path}`;\n            window.history.replaceState(state, \"\", newUrl);\n          } else {\n            window.location.hash = path;\n          }\n        } else {\n          const url =\n            this.options.mode === \"query\" ? this._buildQueryUrl(path) : path;\n          history[historyMethod](state, \"\", url);\n        }\n\n        // Only reset the flag if no newer navigation has started\n        queueMicrotask(() => {\n          if (this._navigationId === currentNavId) {\n            this._isNavigating = false;\n          }\n        });\n      }\n\n      return navigationSuccessful;\n    } catch (error) {\n      this.errorHandler.log(\"Navigation failed\", error);\n      await this.emitter.emit(\"router:onError\", error);\n      return false;\n    }\n  }\n\n  /**\n   * Builds a URL for query mode.\n   * @private\n   * @param {string} path - The path to set as the query parameter.\n   * @returns {string} The full URL with the updated query string.\n   */\n  _buildQueryUrl(path) {\n    const urlParams = new URLSearchParams(window.location.search);\n    urlParams.set(this.options.queryParam, path.split(\"?\")[0]);\n    return `${window.location.pathname}?${urlParams.toString()}`;\n  }\n\n  /**\n   * Checks if the target route is identical to the current route.\n   * @private\n   * @param {string} path - The target path with query string.\n   * @param {object} params - The target params.\n   * @param {object} query - The target query.\n   * @returns {boolean} - True if the routes are the same.\n   */\n  _isSameRoute(path, params, query) {\n    const current = this.currentRoute.value;\n    if (!current) return false;\n    const [targetPath, queryString] = path.split(\"?\");\n    const targetQuery = query || this._parseQuery(queryString || \"\");\n    return (\n      current.path === targetPath &&\n      JSON.stringify(current.params) === JSON.stringify(params || {}) &&\n      JSON.stringify(current.query) === JSON.stringify(targetQuery)\n    );\n  }\n\n  /**\n   * Injects dynamic parameters into a path string.\n   * @private\n   */\n  _buildPath(path, params) {\n    let result = path;\n    for (const [key, value] of Object.entries(params)) {\n      // Fix: Handle special characters and ensure proper encoding\n      const encodedValue = encodeURIComponent(String(value));\n      result = result.replace(new RegExp(`:${key}\\\\b`, \"g\"), encodedValue);\n    }\n    return result;\n  }\n\n  /**\n   * The handler for browser-initiated route changes (e.g., back/forward buttons).\n   * @private\n   * @param {boolean} [isPopState=true] - Whether this is a popstate event (back/forward navigation).\n   */\n  async _handleRouteChange(isPopState = true) {\n    if (this._isNavigating) return;\n\n    try {\n      const from = this.currentRoute.value;\n      const toLocation = this._getCurrentLocation();\n\n      const navigationSuccessful = await this._proceedWithNavigation(\n        toLocation.fullUrl,\n        isPopState\n      );\n\n      // If navigation was blocked by a guard, revert the URL change\n      if (!navigationSuccessful && from) {\n        this.navigate({ path: from.path, query: from.query, replace: true });\n      }\n    } catch (error) {\n      this.errorHandler.log(\"Route change handling failed\", error, {\n        currentUrl: typeof window !== \"undefined\" ? window.location.href : \"\",\n      });\n      await this.emitter.emit(\"router:onError\", error);\n    }\n  }\n\n  /**\n   * Manages the core navigation lifecycle. Runs guards before committing changes.\n   * Emits lifecycle events that plugins can hook into:\n   * - router:beforeEach - Before guards run (can block/redirect via context)\n   * - router:beforeResolve - Before component resolution (can block/redirect)\n   * - router:afterResolve - After components are resolved\n   * - router:beforeRender - Before DOM rendering\n   * - router:afterRender - After DOM rendering\n   * - router:scroll - After render, for scroll behavior\n   * - router:afterEnter - After entering a route\n   * - router:afterLeave - After leaving a route\n   * - router:afterEach - After navigation completes\n   *\n   * @private\n   * @param {string} fullPath - The full path (e.g., '/users/123?foo=bar') to navigate to.\n   * @param {boolean} [isPopState=false] - Whether this navigation was triggered by popstate (back/forward).\n   * @returns {Promise<boolean>} - `true` if navigation succeeded, `false` if aborted.\n   */\n  async _proceedWithNavigation(fullPath, isPopState = false) {\n    const from = this.currentRoute.value;\n    const [path, queryString] = (fullPath || \"/\").split(\"?\");\n    const toLocation = {\n      path: path.startsWith(\"/\") ? path : `/${path}`,\n      query: this._parseQuery(queryString),\n      fullUrl: fullPath,\n    };\n\n    let toMatch = this._matchRoute(toLocation.path);\n\n    if (!toMatch) {\n      const notFoundRoute = this.routes.find((route) => route.path === \"*\");\n      if (notFoundRoute) {\n        toMatch = {\n          route: notFoundRoute,\n          params: {\n            pathMatch: decodeURIComponent(toLocation.path.substring(1)),\n          },\n        };\n      } else {\n        await this.emitter.emit(\n          \"router:onError\",\n          new Error(`Route not found: ${toLocation.path}`),\n          toLocation,\n          from\n        );\n        return false;\n      }\n    }\n\n    const to = {\n      ...toLocation,\n      params: toMatch.params,\n      meta: toMatch.route.meta || {},\n      name: toMatch.route.name,\n      matched: toMatch.route,\n    };\n\n    try {\n      // 1. Run all *pre-navigation* guards.\n      const canNavigate = await this._runGuards(to, from, toMatch.route);\n      if (!canNavigate) return false;\n\n      // 2. Save current scroll position before navigating away\n      if (from && typeof window !== \"undefined\") {\n        this._scrollPositions.set(from.path, {\n          x: window.scrollX || window.pageXOffset || 0,\n          y: window.scrollY || window.pageYOffset || 0,\n        });\n      }\n\n      // 3. Emit beforeResolve event - plugins can show loading indicators\n      /** @type {ResolveContext} */\n      const resolveContext = {\n        to,\n        from,\n        route: toMatch.route,\n        layoutComponent: null,\n        pageComponent: null,\n        cancelled: false,\n        redirectTo: null,\n      };\n      await this.emitter.emit(\"router:beforeResolve\", resolveContext);\n\n      // Check if resolution was cancelled or redirected\n      if (resolveContext.cancelled) return false;\n      if (resolveContext.redirectTo) {\n        this.navigate(resolveContext.redirectTo);\n        return false;\n      }\n\n      // 4. Resolve async components *before* touching the DOM.\n      const { layoutComponent, pageComponent } = await this._resolveComponents(\n        toMatch.route\n      );\n\n      // 5. Emit afterResolve event - plugins can hide loading indicators\n      resolveContext.layoutComponent = layoutComponent;\n      resolveContext.pageComponent = pageComponent;\n      await this.emitter.emit(\"router:afterResolve\", resolveContext);\n\n      // 6. Unmount the previous view/layout.\n      if (from) {\n        const toLayout = toMatch.route.layout || this.options.globalLayout;\n        const fromLayout = from.matched.layout || this.options.globalLayout;\n\n        const tryUnmount = async (instance) => {\n          if (!instance) return;\n\n          try {\n            await instance.unmount();\n          } catch (error) {\n            this.errorHandler.warn(\"Error during component unmount\", {\n              error,\n              instance,\n            });\n          }\n        };\n\n        if (toLayout !== fromLayout) {\n          await tryUnmount(this.currentLayout.value);\n          this.currentLayout.value = null;\n        } else {\n          await tryUnmount(this.currentView.value);\n          this.currentView.value = null;\n        }\n\n        // Call `afterLeave` hook *after* the old component has been unmounted.\n        if (from.matched.afterLeave) {\n          await from.matched.afterLeave(to, from);\n        }\n        await this.emitter.emit(\"router:afterLeave\", to, from);\n      }\n\n      // 7. Update reactive state.\n      this.previousRoute.value = from;\n      this.currentRoute.value = to;\n      this.currentParams.value = to.params || {};\n      this.currentQuery.value = to.query || {};\n\n      // 8. Emit beforeRender event - plugins can add transitions\n      /** @type {RenderContext} */\n      const renderContext = {\n        to,\n        from,\n        layoutComponent,\n        pageComponent,\n      };\n      await this.emitter.emit(\"router:beforeRender\", renderContext);\n\n      // 9. Render the new components.\n      await this._render(layoutComponent, pageComponent, to);\n\n      // 10. Emit afterRender event - plugins can trigger animations\n      await this.emitter.emit(\"router:afterRender\", renderContext);\n\n      // 11. Emit scroll event - plugins can handle scroll restoration\n      /** @type {ScrollContext} */\n      const scrollContext = {\n        to,\n        from,\n        savedPosition: isPopState\n          ? this._scrollPositions.get(to.path) || null\n          : null,\n      };\n      await this.emitter.emit(\"router:scroll\", scrollContext);\n\n      // 12. Run post-navigation hooks.\n      if (toMatch.route.afterEnter) {\n        await toMatch.route.afterEnter(to, from);\n      }\n      await this.emitter.emit(\"router:afterEnter\", to, from);\n      await this.emitter.emit(\"router:afterEach\", to, from);\n\n      return true;\n    } catch (error) {\n      this.errorHandler.log(\"Error during navigation\", error, { to, from });\n      await this.emitter.emit(\"router:onError\", error, to, from);\n      return false;\n    }\n  }\n\n  /**\n   * Executes all applicable navigation guards for a transition in order.\n   * Guards are executed in the following order:\n   * 1. Global beforeEach event (emitter-based, can block via context)\n   * 2. Global beforeEach guards (registered via onBeforeEach)\n   * 3. Route-specific beforeLeave guard (from the route being left)\n   * 4. Route-specific beforeEnter guard (from the route being entered)\n   *\n   * @private\n   * @param {RouteLocation} to - The target route location.\n   * @param {RouteLocation | null} from - The current route location (null on initial navigation).\n   * @param {RouteDefinition} route - The matched route definition.\n   * @returns {Promise<boolean>} - `false` if navigation should be aborted.\n   */\n  async _runGuards(to, from, route) {\n    // Create navigation context that plugins can modify to block navigation\n    /** @type {NavigationContext} */\n    const navContext = {\n      to,\n      from,\n      cancelled: false,\n      redirectTo: null,\n    };\n\n    // Emit beforeEach event with context - plugins can block by modifying context\n    await this.emitter.emit(\"router:beforeEach\", navContext);\n\n    // Check if navigation was cancelled or redirected by event listeners\n    if (navContext.cancelled) return false;\n    if (navContext.redirectTo) {\n      this.navigate(navContext.redirectTo);\n      return false;\n    }\n\n    // Collect all guards in execution order\n    const guards = [\n      ...this._beforeEachGuards,\n      ...(from && from.matched.beforeLeave ? [from.matched.beforeLeave] : []),\n      ...(route.beforeEnter ? [route.beforeEnter] : []),\n    ];\n\n    for (const guard of guards) {\n      const result = await guard(to, from);\n      if (result === false) return false;\n      if (typeof result === \"string\" || typeof result === \"object\") {\n        this.navigate(result);\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Resolves a string component definition to a component object.\n   * @private\n   * @param {string} def - The component name to resolve.\n   * @returns {ComponentDefinition} The resolved component.\n   * @throws {Error} If the component is not registered.\n   *\n   * @note Core plugins (Router, Attr, Props, Store) may access eleva._components\n   * directly. This is intentional and stable for official Eleva plugins shipped\n   * with the framework. Third-party plugins should use eleva.component() for\n   * registration and avoid direct access to internal APIs.\n   */\n  _resolveStringComponent(def) {\n    const componentDef = this.eleva._components.get(def);\n    if (!componentDef) {\n      this.errorHandler.handle(\n        new Error(`Component \"${def}\" not registered.`),\n        \"Component resolution failed\",\n        {\n          componentName: def,\n          availableComponents: Array.from(this.eleva._components.keys()),\n        }\n      );\n    }\n    return componentDef;\n  }\n\n  /**\n   * Resolves a function component definition to a component object.\n   * @private\n   * @param {Function} def - The function to resolve.\n   * @returns {Promise<ComponentDefinition>} The resolved component.\n   * @throws {Error} If the function fails to load the component.\n   */\n  async _resolveFunctionComponent(def) {\n    try {\n      const funcStr = def.toString();\n      const isAsyncImport =\n        funcStr.includes(\"import(\") || funcStr.startsWith(\"() =>\");\n\n      const result = await def();\n      return isAsyncImport ? result.default || result : result;\n    } catch (error) {\n      this.errorHandler.handle(\n        new Error(`Failed to load async component: ${error.message}`),\n        \"Component resolution failed\",\n        { function: def.toString(), error }\n      );\n    }\n  }\n\n  /**\n   * Validates a component definition object.\n   * @private\n   * @param {any} def - The component definition to validate.\n   * @returns {ComponentDefinition} The validated component.\n   * @throws {Error} If the component definition is invalid.\n   */\n  _validateComponentDefinition(def) {\n    if (!def || typeof def !== \"object\") {\n      this.errorHandler.handle(\n        new Error(`Invalid component definition: ${typeof def}`),\n        \"Component validation failed\",\n        { definition: def }\n      );\n    }\n\n    if (\n      typeof def.template !== \"function\" &&\n      typeof def.template !== \"string\"\n    ) {\n      this.errorHandler.handle(\n        new Error(\"Component missing template property\"),\n        \"Component validation failed\",\n        { definition: def }\n      );\n    }\n\n    return def;\n  }\n\n  /**\n   * Resolves a component definition to a component object.\n   * @private\n   * @param {any} def - The component definition to resolve.\n   * @returns {Promise<ComponentDefinition | null>} The resolved component or null.\n   */\n  async _resolveComponent(def) {\n    if (def === null || def === undefined) {\n      return null;\n    }\n\n    if (typeof def === \"string\") {\n      return this._resolveStringComponent(def);\n    }\n\n    if (typeof def === \"function\") {\n      return await this._resolveFunctionComponent(def);\n    }\n\n    if (def && typeof def === \"object\") {\n      return this._validateComponentDefinition(def);\n    }\n\n    this.errorHandler.handle(\n      new Error(`Invalid component definition: ${typeof def}`),\n      \"Component resolution failed\",\n      { definition: def }\n    );\n  }\n\n  /**\n   * Asynchronously resolves the layout and page components for a route.\n   * @private\n   * @param {RouteDefinition} route - The route to resolve components for.\n   * @returns {Promise<{layoutComponent: ComponentDefinition | null, pageComponent: ComponentDefinition}>}\n   */\n  async _resolveComponents(route) {\n    const effectiveLayout = route.layout || this.options.globalLayout;\n\n    try {\n      const [layoutComponent, pageComponent] = await Promise.all([\n        this._resolveComponent(effectiveLayout),\n        this._resolveComponent(route.component),\n      ]);\n\n      if (!pageComponent) {\n        this.errorHandler.handle(\n          new Error(\n            `Page component is null or undefined for route: ${route.path}`\n          ),\n          \"Component resolution failed\",\n          { route: route.path }\n        );\n      }\n\n      return { layoutComponent, pageComponent };\n    } catch (error) {\n      this.errorHandler.log(\n        `Error resolving components for route ${route.path}`,\n        error,\n        { route: route.path }\n      );\n      throw error;\n    }\n  }\n\n  /**\n   * Renders the components for the current route into the DOM.\n   * @private\n   * @param {ComponentDefinition | null} layoutComponent - The pre-loaded layout component.\n   * @param {ComponentDefinition} pageComponent - The pre-loaded page component.\n   */\n  async _render(layoutComponent, pageComponent) {\n    const mountEl = document.querySelector(this.options.mount);\n    if (!mountEl) {\n      this.errorHandler.handle(\n        new Error(`Mount element \"${this.options.mount}\" not found.`),\n        { mountSelector: this.options.mount }\n      );\n    }\n\n    if (layoutComponent) {\n      const layoutInstance = await this.eleva.mount(\n        mountEl,\n        this._wrapComponentWithChildren(layoutComponent)\n      );\n      this.currentLayout.value = layoutInstance;\n      const viewEl = this._findViewElement(layoutInstance.container);\n      const viewInstance = await this.eleva.mount(\n        viewEl,\n        this._wrapComponentWithChildren(pageComponent)\n      );\n      this.currentView.value = viewInstance;\n    } else {\n      const viewInstance = await this.eleva.mount(\n        mountEl,\n        this._wrapComponentWithChildren(pageComponent)\n      );\n      this.currentView.value = viewInstance;\n      this.currentLayout.value = null;\n    }\n  }\n\n  /**\n   * Creates a getter function for router context properties.\n   * @private\n   * @param {string} property - The property name to access.\n   * @param {any} defaultValue - The default value if property is undefined.\n   * @returns {Function} A getter function.\n   */\n  _createRouteGetter(property, defaultValue) {\n    return () => this.currentRoute.value?.[property] ?? defaultValue;\n  }\n\n  /**\n   * Wraps a component definition to inject router-specific context into its setup function.\n   * @private\n   * @param {ComponentDefinition} component - The component to wrap.\n   * @returns {ComponentDefinition} The wrapped component definition.\n   */\n  _wrapComponent(component) {\n    const originalSetup = component.setup;\n    const self = this;\n\n    return {\n      ...component,\n      async setup(ctx) {\n        ctx.router = {\n          navigate: self.navigate.bind(self),\n          current: self.currentRoute,\n          previous: self.previousRoute,\n\n          // Route property getters\n          get params() {\n            return self._createRouteGetter(\"params\", {})();\n          },\n          get query() {\n            return self._createRouteGetter(\"query\", {})();\n          },\n          get path() {\n            return self._createRouteGetter(\"path\", \"/\")();\n          },\n          get fullUrl() {\n            return self._createRouteGetter(\"fullUrl\", window.location.href)();\n          },\n          get meta() {\n            return self._createRouteGetter(\"meta\", {})();\n          },\n        };\n\n        return originalSetup ? await originalSetup(ctx) : {};\n      },\n    };\n  }\n\n  /**\n   * Recursively wraps all child components to ensure they have access to router context.\n   * @private\n   * @param {ComponentDefinition | string} component - The component to wrap (can be a definition object or a registered component name).\n   * @returns {ComponentDefinition | string} The wrapped component definition or the original string reference.\n   */\n  _wrapComponentWithChildren(component) {\n    // If the component is a string (registered component name), return as-is\n    // The router context will be injected when the component is resolved during mounting\n    if (typeof component === \"string\") {\n      return component;\n    }\n\n    // If not a valid component object, return as-is\n    if (!component || typeof component !== \"object\") {\n      return component;\n    }\n\n    const wrappedComponent = this._wrapComponent(component);\n\n    // If the component has children, wrap them too\n    if (\n      wrappedComponent.children &&\n      typeof wrappedComponent.children === \"object\"\n    ) {\n      const wrappedChildren = {};\n      for (const [selector, childComponent] of Object.entries(\n        wrappedComponent.children\n      )) {\n        wrappedChildren[selector] =\n          this._wrapComponentWithChildren(childComponent);\n      }\n      wrappedComponent.children = wrappedChildren;\n    }\n\n    return wrappedComponent;\n  }\n\n  /**\n   * Gets the current location information from the browser's window object.\n   * @private\n   * @returns {Omit<RouteLocation, 'params' | 'meta' | 'name' | 'matched'>}\n   */\n  _getCurrentLocation() {\n    if (typeof window === \"undefined\")\n      return { path: \"/\", query: {}, fullUrl: \"\" };\n    let path, queryString, fullUrl;\n    switch (this.options.mode) {\n      case \"hash\":\n        fullUrl = window.location.hash.slice(1) || \"/\";\n        [path, queryString] = fullUrl.split(\"?\");\n        break;\n      case \"query\":\n        const urlParams = new URLSearchParams(window.location.search);\n        path = urlParams.get(this.options.queryParam) || \"/\";\n        queryString = window.location.search.slice(1);\n        fullUrl = path;\n        break;\n      default: // 'history' mode\n        path = window.location.pathname || \"/\";\n        queryString = window.location.search.slice(1);\n        fullUrl = `${path}${queryString ? \"?\" + queryString : \"\"}`;\n    }\n    return {\n      path: path.startsWith(\"/\") ? path : `/${path}`,\n      query: this._parseQuery(queryString),\n      fullUrl,\n    };\n  }\n\n  /**\n   * Parses a query string into a key-value object.\n   * @private\n   */\n  _parseQuery(queryString) {\n    const query = {};\n    if (queryString) {\n      new URLSearchParams(queryString).forEach((value, key) => {\n        query[key] = value;\n      });\n    }\n    return query;\n  }\n\n  /**\n   * Matches a given path against the registered routes.\n   * @private\n   * @param {string} path - The path to match.\n   * @returns {{route: RouteDefinition, params: Object<string, string>} | null} The matched route and its params, or null.\n   */\n  _matchRoute(path) {\n    const pathSegments = path.split(\"/\").filter(Boolean);\n\n    for (const route of this.routes) {\n      // Handle the root path as a special case.\n      if (route.path === \"/\") {\n        if (pathSegments.length === 0) return { route, params: {} };\n        continue;\n      }\n\n      if (route.segments.length !== pathSegments.length) continue;\n\n      const params = {};\n      let isMatch = true;\n      for (let i = 0; i < route.segments.length; i++) {\n        const routeSegment = route.segments[i];\n        const pathSegment = pathSegments[i];\n        if (routeSegment.type === \"param\") {\n          params[routeSegment.name] = decodeURIComponent(pathSegment);\n        } else if (routeSegment.value !== pathSegment) {\n          isMatch = false;\n          break;\n        }\n      }\n      if (isMatch) return { route, params };\n    }\n    return null;\n  }\n\n  // ============================================\n  // Dynamic Route Management API\n  // ============================================\n\n  /**\n   * Adds a new route dynamically at runtime.\n   * The route will be processed and available for navigation immediately.\n   *\n   * @param {RouteDefinition} route - The route definition to add.\n   * @param {RouteDefinition} [parentRoute] - Optional parent route to add as a child (not yet implemented).\n   * @returns {() => void} A function to remove the added route.\n   *\n   * @example\n   * // Add a route dynamically\n   * const removeRoute = router.addRoute({\n   *   path: '/dynamic',\n   *   component: DynamicPage,\n   *   meta: { title: 'Dynamic Page' }\n   * });\n   *\n   * // Later, remove the route\n   * removeRoute();\n   */\n  addRoute(route, parentRoute = null) {\n    if (!route || !route.path) {\n      this.errorHandler.warn(\"Invalid route definition: missing path\", {\n        route,\n      });\n      return () => {};\n    }\n\n    // Check if route already exists\n    if (this.hasRoute(route.path)) {\n      this.errorHandler.warn(`Route \"${route.path}\" already exists`, { route });\n      return () => {};\n    }\n\n    // Process the route (parse segments)\n    const processedRoute = {\n      ...route,\n      segments: this._parsePathIntoSegments(route.path),\n    };\n\n    // Add to routes array (before wildcard if exists)\n    const wildcardIndex = this.routes.findIndex((r) => r.path === \"*\");\n    if (wildcardIndex !== -1) {\n      this.routes.splice(wildcardIndex, 0, processedRoute);\n    } else {\n      this.routes.push(processedRoute);\n    }\n\n    // Emit event for plugins\n    this.emitter.emit(\"router:routeAdded\", processedRoute);\n\n    // Return removal function\n    return () => this.removeRoute(route.path);\n  }\n\n  /**\n   * Removes a route by its path.\n   *\n   * @param {string} path - The path of the route to remove.\n   * @returns {boolean} True if the route was removed, false if not found.\n   *\n   * @example\n   * router.removeRoute('/dynamic');\n   */\n  removeRoute(path) {\n    const index = this.routes.findIndex((r) => r.path === path);\n    if (index === -1) {\n      return false;\n    }\n\n    const [removedRoute] = this.routes.splice(index, 1);\n\n    // Emit event for plugins\n    this.emitter.emit(\"router:routeRemoved\", removedRoute);\n\n    return true;\n  }\n\n  /**\n   * Checks if a route with the given path exists.\n   *\n   * @param {string} path - The path to check.\n   * @returns {boolean} True if the route exists.\n   *\n   * @example\n   * if (router.hasRoute('/users/:id')) {\n   *   console.log('User route exists');\n   * }\n   */\n  hasRoute(path) {\n    return this.routes.some((r) => r.path === path);\n  }\n\n  /**\n   * Gets all registered routes.\n   *\n   * @returns {RouteDefinition[]} A copy of the routes array.\n   *\n   * @example\n   * const routes = router.getRoutes();\n   * console.log('Available routes:', routes.map(r => r.path));\n   */\n  getRoutes() {\n    return [...this.routes];\n  }\n\n  /**\n   * Gets a route by its path.\n   *\n   * @param {string} path - The path of the route to get.\n   * @returns {RouteDefinition | undefined} The route definition or undefined.\n   *\n   * @example\n   * const route = router.getRoute('/users/:id');\n   * if (route) {\n   *   console.log('Route meta:', route.meta);\n   * }\n   */\n  getRoute(path) {\n    return this.routes.find((r) => r.path === path);\n  }\n\n  // ============================================\n  // Hook Registration Methods\n  // ============================================\n\n  /**\n   * Registers a global pre-navigation guard.\n   * Multiple guards can be registered and will be executed in order.\n   * Guards can also be registered via the emitter using `router:beforeEach` event.\n   *\n   * @param {NavigationGuard} guard - The guard function to register.\n   * @returns {() => void} A function to unregister the guard.\n   *\n   * @example\n   * // Register a guard\n   * const unregister = router.onBeforeEach((to, from) => {\n   *   if (to.meta.requiresAuth && !isAuthenticated()) {\n   *     return '/login';\n   *   }\n   * });\n   *\n   * // Later, unregister the guard\n   * unregister();\n   */\n  onBeforeEach(guard) {\n    this._beforeEachGuards.push(guard);\n    return () => {\n      const index = this._beforeEachGuards.indexOf(guard);\n      if (index > -1) {\n        this._beforeEachGuards.splice(index, 1);\n      }\n    };\n  }\n  /**\n   * Registers a global hook that runs after a new route component has been mounted.\n   * @param {NavigationHook} hook - The hook function to register.\n   * @returns {() => void} A function to unregister the hook.\n   */\n  onAfterEnter(hook) {\n    return this.emitter.on(\"router:afterEnter\", hook);\n  }\n\n  /**\n   * Registers a global hook that runs after a route component has been unmounted.\n   * @param {NavigationHook} hook - The hook function to register.\n   * @returns {() => void} A function to unregister the hook.\n   */\n  onAfterLeave(hook) {\n    return this.emitter.on(\"router:afterLeave\", hook);\n  }\n\n  /**\n   * Registers a global hook that runs after a navigation has been confirmed and all hooks have completed.\n   * @param {NavigationHook} hook - The hook function to register.\n   * @returns {() => void} A function to unregister the hook.\n   */\n  onAfterEach(hook) {\n    return this.emitter.on(\"router:afterEach\", hook);\n  }\n\n  /**\n   * Registers a global error handler for navigation errors.\n   * @param {(error: Error, to?: RouteLocation, from?: RouteLocation) => void} handler - The error handler function.\n   * @returns {() => void} A function to unregister the handler.\n   */\n  onError(handler) {\n    return this.emitter.on(\"router:onError\", handler);\n  }\n\n  /**\n   * Registers a plugin with the router.\n   * @param {RouterPlugin} plugin - The plugin to register.\n   */\n  use(plugin, options = {}) {\n    if (typeof plugin.install !== \"function\") {\n      this.errorHandler.handle(\n        new Error(\"Plugin must have an install method\"),\n        \"Plugin registration failed\",\n        { plugin }\n      );\n    }\n\n    // Check if plugin is already registered\n    if (this.plugins.has(plugin.name)) {\n      this.errorHandler.warn(`Plugin \"${plugin.name}\" is already registered`, {\n        existingPlugin: this.plugins.get(plugin.name),\n      });\n      return;\n    }\n\n    this.plugins.set(plugin.name, plugin);\n    plugin.install(this, options);\n  }\n\n  /**\n   * Gets all registered plugins.\n   * @returns {RouterPlugin[]} Array of registered plugins.\n   */\n  getPlugins() {\n    return Array.from(this.plugins.values());\n  }\n\n  /**\n   * Gets a plugin by name.\n   * @param {string} name - The plugin name.\n   * @returns {RouterPlugin | undefined} The plugin or undefined.\n   */\n  getPlugin(name) {\n    return this.plugins.get(name);\n  }\n\n  /**\n   * Removes a plugin from the router.\n   * @param {string} name - The plugin name.\n   * @returns {boolean} True if the plugin was removed.\n   */\n  removePlugin(name) {\n    const plugin = this.plugins.get(name);\n    if (!plugin) return false;\n\n    // Call destroy if available\n    if (typeof plugin.destroy === \"function\") {\n      try {\n        plugin.destroy(this);\n      } catch (error) {\n        this.errorHandler.log(`Plugin ${name} destroy failed`, error);\n      }\n    }\n\n    return this.plugins.delete(name);\n  }\n\n  /**\n   * Sets a custom error handler. Used by error handling plugins.\n   * @param {Object} errorHandler - The error handler object with handle, warn, and log methods.\n   */\n  setErrorHandler(errorHandler) {\n    if (\n      errorHandler &&\n      typeof errorHandler.handle === \"function\" &&\n      typeof errorHandler.warn === \"function\" &&\n      typeof errorHandler.log === \"function\"\n    ) {\n      this.errorHandler = errorHandler;\n    } else {\n      console.warn(\n        \"[ElevaRouter] Invalid error handler provided. Must have handle, warn, and log methods.\"\n      );\n    }\n  }\n}\n\n/**\n * @typedef {Object} RouterOptions\n * @property {string} mount - A CSS selector for the main element where the app is mounted.\n * @property {RouteDefinition[]} routes - An array of route definitions.\n * @property {'hash' | 'query' | 'history'} [mode='hash'] - The routing mode.\n * @property {string} [queryParam='page'] - The query parameter to use in 'query' mode.\n * @property {string} [viewSelector='view'] - The selector for the view element within a layout.\n * @property {boolean} [autoStart=true] - Whether to start the router automatically.\n * @property {NavigationGuard} [onBeforeEach] - A global guard executed before every navigation.\n * @property {string | ComponentDefinition | (() => Promise<{default: ComponentDefinition}>)} [globalLayout] - A global layout for all routes. Can be overridden by a route's specific layout.\n */\n\n/**\n * @class ðŸš€ RouterPlugin\n * @classdesc A powerful, reactive, and flexible Router Plugin for Eleva.js applications.\n * This plugin provides comprehensive client-side routing functionality including:\n * - Multiple routing modes (hash, history, query)\n * - Navigation guards and lifecycle hooks\n * - Reactive state management\n * - Component resolution and lazy loading\n * - Layout and page component separation\n * - Plugin system for extensibility\n * - Advanced error handling\n *\n * @example\n * // Install the plugin\n * const app = new Eleva(\"myApp\");\n *\n * const HomePage = { template: () => `<h1>Home</h1>` };\n * const AboutPage = { template: () => `<h1>About Us</h1>` };\n * const UserPage = {\n *   template: (ctx) => `<h1>User: ${ctx.router.params.id}</h1>`\n * };\n *\n * app.use(RouterPlugin, {\n *   mount: '#app',\n *   mode: 'hash',\n *   routes: [\n *     { path: '/', component: HomePage },\n *     { path: '/about', component: AboutPage },\n *     { path: '/users/:id', component: UserPage }\n *   ]\n * });\n */\nexport const RouterPlugin = {\n  /**\n   * Unique identifier for the plugin\n   * @type {string}\n   */\n  name: \"router\",\n\n  /**\n   * Plugin version\n   * @type {string}\n   */\n  version: \"1.0.0-rc.10\",\n\n  /**\n   * Plugin description\n   * @type {string}\n   */\n  description: \"Client-side routing for Eleva applications\",\n\n  /**\n   * Installs the RouterPlugin into an Eleva instance.\n   *\n   * @param {Eleva} eleva - The Eleva instance\n   * @param {RouterOptions} options - Router configuration options\n   * @param {string} options.mount - A CSS selector for the main element where the app is mounted\n   * @param {RouteDefinition[]} options.routes - An array of route definitions\n   * @param {'hash' | 'query' | 'history'} [options.mode='hash'] - The routing mode\n   * @param {string} [options.queryParam='page'] - The query parameter to use in 'query' mode\n   * @param {string} [options.viewSelector='view'] - The selector for the view element within a layout\n   * @param {boolean} [options.autoStart=true] - Whether to start the router automatically\n   * @param {NavigationGuard} [options.onBeforeEach] - A global guard executed before every navigation\n   * @param {string | ComponentDefinition | (() => Promise<{default: ComponentDefinition}>)} [options.globalLayout] - A global layout for all routes\n   *\n   * @example\n   * // main.js\n   * import Eleva from './eleva.js';\n   * import { RouterPlugin } from './plugins/RouterPlugin.js';\n   *\n   * const app = new Eleva('myApp');\n   *\n   * const HomePage = { template: () => `<h1>Home</h1>` };\n   * const AboutPage = { template: () => `<h1>About Us</h1>` };\n   *\n   * app.use(RouterPlugin, {\n   *  mount: '#app',\n   *  routes: [\n   *    { path: '/', component: HomePage },\n   *    { path: '/about', component: AboutPage }\n   *  ]\n   * });\n   */\n  install(eleva, options = {}) {\n    if (!options.mount) {\n      throw new Error(\"[RouterPlugin] 'mount' option is required\");\n    }\n\n    if (!options.routes || !Array.isArray(options.routes)) {\n      throw new Error(\"[RouterPlugin] 'routes' option must be an array\");\n    }\n\n    /**\n     * Registers a component definition with the Eleva instance.\n     * This method handles both inline component objects and pre-registered component names.\n     *\n     * @param {any} def - The component definition to register\n     * @param {string} type - The type of component for naming (e.g., \"Route\", \"Layout\")\n     * @returns {string | null} The registered component name or null if no definition provided\n     */\n    const register = (def, type) => {\n      if (!def) return null;\n\n      if (typeof def === \"object\" && def !== null && !def.name) {\n        const name = `Eleva${type}Component_${Math.random()\n          .toString(36)\n          .slice(2, 11)}`;\n\n        try {\n          eleva.component(name, def);\n          return name;\n        } catch (error) {\n          throw new Error(\n            `[RouterPlugin] Failed to register ${type} component: ${error.message}`\n          );\n        }\n      }\n      return def;\n    };\n\n    if (options.globalLayout) {\n      options.globalLayout = register(options.globalLayout, \"GlobalLayout\");\n    }\n\n    (options.routes || []).forEach((route) => {\n      route.component = register(route.component, \"Route\");\n      if (route.layout) {\n        route.layout = register(route.layout, \"RouteLayout\");\n      }\n    });\n\n    const router = new Router(eleva, options);\n    eleva.router = router;\n\n    if (options.autoStart !== false) {\n      queueMicrotask(() => router.start());\n    }\n\n    // Add plugin metadata to the Eleva instance\n    if (!eleva.plugins) {\n      eleva.plugins = new Map();\n    }\n    eleva.plugins.set(this.name, {\n      name: this.name,\n      version: this.version,\n      description: this.description,\n      options,\n    });\n\n    // Add utility methods for manual router access\n    eleva.navigate = router.navigate.bind(router);\n    eleva.getCurrentRoute = () => router.currentRoute.value;\n    eleva.getRouteParams = () => router.currentParams.value;\n    eleva.getRouteQuery = () => router.currentQuery.value;\n\n    return router;\n  },\n\n  /**\n   * Uninstalls the plugin from the Eleva instance\n   *\n   * @param {Eleva} eleva - The Eleva instance\n   */\n  async uninstall(eleva) {\n    if (eleva.router) {\n      await eleva.router.destroy();\n      delete eleva.router;\n    }\n\n    // Remove plugin metadata\n    if (eleva.plugins) {\n      eleva.plugins.delete(this.name);\n    }\n\n    // Remove utility methods\n    delete eleva.navigate;\n    delete eleva.getCurrentRoute;\n    delete eleva.getRouteParams;\n    delete eleva.getRouteQuery;\n  },\n};\n","\"use strict\";\n\n// ============================================================================\n// TYPE DEFINITIONS - TypeScript-friendly JSDoc types for IDE support\n// ============================================================================\n\n/**\n * @typedef {Record<string, unknown>} TemplateData\n *           Data context for template interpolation\n */\n\n/**\n * @typedef {string} TemplateString\n *           A string containing {{ expression }} interpolation markers\n */\n\n/**\n * @typedef {string} Expression\n *           A JavaScript expression to be evaluated in the data context\n */\n\n/**\n * @typedef {unknown} EvaluationResult\n *           The result of evaluating an expression (string, number, boolean, object, etc.)\n */\n\n/**\n * @class ðŸ”’ TemplateEngine\n * @classdesc A secure template engine that handles interpolation and dynamic attribute parsing.\n * Provides a way to evaluate expressions in templates.\n * All methods are static and can be called directly on the class.\n *\n * Template Syntax:\n * - `{{ expression }}` - Interpolate any JavaScript expression\n * - `{{ variable }}` - Access data properties directly\n * - `{{ object.property }}` - Access nested properties\n * - `{{ condition ? a : b }}` - Ternary expressions\n * - `{{ func(arg) }}` - Call functions from data context\n *\n * @example\n * // Basic interpolation\n * const template = \"Hello, {{name}}!\";\n * const data = { name: \"World\" };\n * const result = TemplateEngine.parse(template, data);\n * // Result: \"Hello, World!\"\n *\n * @example\n * // Nested properties\n * const template = \"Welcome, {{user.name}}!\";\n * const data = { user: { name: \"John\" } };\n * const result = TemplateEngine.parse(template, data);\n * // Result: \"Welcome, John!\"\n *\n * @example\n * // Expressions\n * const template = \"Status: {{active ? 'Online' : 'Offline'}}\";\n * const data = { active: true };\n * const result = TemplateEngine.parse(template, data);\n * // Result: \"Status: Online\"\n *\n * @example\n * // With Signal values\n * const template = \"Count: {{count.value}}\";\n * const data = { count: { value: 42 } };\n * const result = TemplateEngine.parse(template, data);\n * // Result: \"Count: 42\"\n */\nexport class TemplateEngine {\n  /**\n   * Regular expression for matching template expressions in the format {{ expression }}\n   * Matches: {{ anything }} with optional whitespace inside braces\n   *\n   * @static\n   * @private\n   * @type {RegExp}\n   */\n  static expressionPattern = /\\{\\{\\s*(.*?)\\s*\\}\\}/g;\n\n  /**\n   * Parses a template string, replacing expressions with their evaluated values.\n   * Expressions are evaluated in the provided data context.\n   *\n   * @public\n   * @static\n   * @param {TemplateString|unknown} template - The template string to parse.\n   * @param {TemplateData} data - The data context for evaluating expressions.\n   * @returns {string} The parsed template with expressions replaced by their values.\n   *\n   * @example\n   * // Simple variables\n   * TemplateEngine.parse(\"Hello, {{name}}!\", { name: \"World\" });\n   * // Result: \"Hello, World!\"\n   *\n   * @example\n   * // Nested properties\n   * TemplateEngine.parse(\"{{user.name}} is {{user.age}} years old\", {\n   *   user: { name: \"John\", age: 30 }\n   * });\n   * // Result: \"John is 30 years old\"\n   *\n   * @example\n   * // Multiple expressions\n   * TemplateEngine.parse(\"{{greeting}}, {{name}}! You have {{count}} messages.\", {\n   *   greeting: \"Hello\",\n   *   name: \"User\",\n   *   count: 5\n   * });\n   * // Result: \"Hello, User! You have 5 messages.\"\n   *\n   * @example\n   * // With conditionals\n   * TemplateEngine.parse(\"Status: {{online ? 'Active' : 'Inactive'}}\", {\n   *   online: true\n   * });\n   * // Result: \"Status: Active\"\n   */\n  static parse(template, data) {\n    if (typeof template !== \"string\") return template;\n    return template.replace(this.expressionPattern, (_, expression) =>\n      this.evaluate(expression, data)\n    );\n  }\n\n  /**\n   * Evaluates an expression in the context of the provided data object.\n   *\n   * Note: This does not provide a true sandbox and evaluated expressions may access global scope.\n   * The use of the `with` statement is necessary for expression evaluation but has security implications.\n   * Only use with trusted templates. User input should never be directly interpolated.\n   *\n   * @public\n   * @static\n   * @param {Expression|unknown} expression - The expression to evaluate.\n   * @param {TemplateData} data - The data context for evaluation.\n   * @returns {EvaluationResult} The result of the evaluation, or an empty string if evaluation fails.\n   *\n   * @example\n   * // Property access\n   * TemplateEngine.evaluate(\"user.name\", { user: { name: \"John\" } });\n   * // Result: \"John\"\n   *\n   * @example\n   * // Numeric values\n   * TemplateEngine.evaluate(\"user.age\", { user: { age: 30 } });\n   * // Result: 30\n   *\n   * @example\n   * // Expressions\n   * TemplateEngine.evaluate(\"items.length > 0\", { items: [1, 2, 3] });\n   * // Result: true\n   *\n   * @example\n   * // Function calls\n   * TemplateEngine.evaluate(\"formatDate(date)\", {\n   *   date: new Date(),\n   *   formatDate: (d) => d.toISOString()\n   * });\n   * // Result: \"2024-01-01T00:00:00.000Z\"\n   *\n   * @example\n   * // Failed evaluation returns empty string\n   * TemplateEngine.evaluate(\"nonexistent.property\", {});\n   * // Result: \"\"\n   */\n  static evaluate(expression, data) {\n    if (typeof expression !== \"string\") return expression;\n    try {\n      return new Function(\"data\", `with(data) { return ${expression}; }`)(data);\n    } catch {\n      return \"\";\n    }\n  }\n}\n","\"use strict\";\n\nimport { TemplateEngine } from \"../modules/TemplateEngine.js\";\n\n/**\n * @class ðŸŽ¯ PropsPlugin\n * @classdesc A plugin that extends Eleva's props data handling to support any type of data structure\n * with automatic type detection, parsing, and reactive prop updates. This plugin enables seamless\n * passing of complex data types from parent to child components without manual parsing.\n *\n * Core Features:\n * - Automatic type detection and parsing (strings, numbers, booleans, objects, arrays, dates, etc.)\n * - Support for complex data structures including nested objects and arrays\n * - Reactive props that automatically update when parent data changes\n * - Comprehensive error handling with custom error callbacks\n * - Simple configuration with minimal setup required\n *\n * @example\n * // Install the plugin\n * const app = new Eleva(\"myApp\");\n * app.use(PropsPlugin, {\n *   enableAutoParsing: true,\n *   enableReactivity: true,\n *   onError: (error, value) => {\n *     console.error('Props parsing error:', error, value);\n *   }\n * });\n *\n * // Use complex props in components\n * app.component(\"UserCard\", {\n *   template: (ctx) => `\n *     <div class=\"user-info-container\"\n *          :user='${JSON.stringify(ctx.user.value)}'\n *          :permissions='${JSON.stringify(ctx.permissions.value)}'\n *          :settings='${JSON.stringify(ctx.settings.value)}'>\n *     </div>\n *   `,\n *   children: {\n *     '.user-info-container': 'UserInfo'\n *   }\n * });\n *\n * app.component(\"UserInfo\", {\n *   setup({ props }) {\n *     return {\n *       user: props.user,        // Automatically parsed object\n *       permissions: props.permissions,  // Automatically parsed array\n *       settings: props.settings  // Automatically parsed object\n *     };\n *   }\n * });\n */\nexport const PropsPlugin = {\n  /**\n   * Unique identifier for the plugin\n   * @type {string}\n   */\n  name: \"props\",\n\n  /**\n   * Plugin version\n   * @type {string}\n   */\n  version: \"1.0.0-rc.10\",\n\n  /**\n   * Plugin description\n   * @type {string}\n   */\n  description:\n    \"Advanced props data handling for complex data structures with automatic type detection and reactivity\",\n\n  /**\n   * Installs the plugin into the Eleva instance\n   *\n   * @param {Object} eleva - The Eleva instance\n   * @param {Object} options - Plugin configuration options\n   * @param {boolean} [options.enableAutoParsing=true] - Enable automatic type detection and parsing\n   * @param {boolean} [options.enableReactivity=true] - Enable reactive prop updates using Eleva's signal system\n   * @param {Function} [options.onError=null] - Error handler function called when parsing fails\n   *\n   * @example\n   * // Basic installation\n   * app.use(PropsPlugin);\n   *\n   * // Installation with custom options\n   * app.use(PropsPlugin, {\n   *   enableAutoParsing: true,\n   *   enableReactivity: false,\n   *   onError: (error, value) => {\n   *     console.error('Props parsing error:', error, value);\n   *   }\n   * });\n   */\n  install(eleva, options = {}) {\n    const {\n      enableAutoParsing = true,\n      enableReactivity = true,\n      onError = null,\n    } = options;\n\n    /**\n     * Detects the type of a given value\n     * @private\n     * @param {any} value - The value to detect type for\n     * @returns {string} The detected type ('string', 'number', 'boolean', 'object', 'array', 'date', 'map', 'set', 'function', 'null', 'undefined', 'unknown')\n     *\n     * @example\n     * detectType(\"hello\")     // â†’ \"string\"\n     * detectType(42)          // â†’ \"number\"\n     * detectType(true)        // â†’ \"boolean\"\n     * detectType([1, 2, 3])   // â†’ \"array\"\n     * detectType({})          // â†’ \"object\"\n     * detectType(new Date())  // â†’ \"date\"\n     * detectType(null)        // â†’ \"null\"\n     */\n    const detectType = (value) => {\n      if (value === null) return \"null\";\n      if (value === undefined) return \"undefined\";\n      if (typeof value === \"boolean\") return \"boolean\";\n      if (typeof value === \"number\") return \"number\";\n      if (typeof value === \"string\") return \"string\";\n      if (typeof value === \"function\") return \"function\";\n      if (value instanceof Date) return \"date\";\n      if (value instanceof Map) return \"map\";\n      if (value instanceof Set) return \"set\";\n      if (Array.isArray(value)) return \"array\";\n      if (typeof value === \"object\") return \"object\";\n      return \"unknown\";\n    };\n\n    /**\n     * Parses a prop value with automatic type detection\n     * @private\n     * @param {any} value - The value to parse\n     * @returns {any} The parsed value with appropriate type\n     *\n     * @description\n     * This function automatically detects and parses different data types from string values:\n     * - Special strings: \"true\" â†’ true, \"false\" â†’ false, \"null\" â†’ null, \"undefined\" â†’ undefined\n     * - JSON objects/arrays: '{\"key\": \"value\"}' â†’ {key: \"value\"}, '[1, 2, 3]' â†’ [1, 2, 3]\n     * - Boolean-like strings: \"1\" â†’ true, \"0\" â†’ false, \"\" â†’ true\n     * - Numeric strings: \"42\" â†’ 42, \"3.14\" â†’ 3.14\n     * - Date strings: \"2023-01-01T00:00:00.000Z\" â†’ Date object\n     * - Other strings: returned as-is\n     *\n     * @example\n     * parsePropValue(\"true\")           // â†’ true\n     * parsePropValue(\"42\")             // â†’ 42\n     * parsePropValue('{\"key\": \"val\"}') // â†’ {key: \"val\"}\n     * parsePropValue('[1, 2, 3]')      // â†’ [1, 2, 3]\n     * parsePropValue(\"hello\")          // â†’ \"hello\"\n     */\n    const parsePropValue = (value) => {\n      try {\n        // Handle non-string values - return as-is\n        if (typeof value !== \"string\") {\n          return value;\n        }\n\n        // Handle special string patterns first\n        if (value === \"true\") return true;\n        if (value === \"false\") return false;\n        if (value === \"null\") return null;\n        if (value === \"undefined\") return undefined;\n\n        // Try to parse as JSON (for objects and arrays)\n        // This handles complex data structures like objects and arrays\n        if (value.startsWith(\"{\") || value.startsWith(\"[\")) {\n          try {\n            return JSON.parse(value);\n          } catch (e) {\n            // Not valid JSON, throw error to trigger error handler\n            throw new Error(`Invalid JSON: ${value}`);\n          }\n        }\n\n        // Handle boolean-like strings (including \"1\" and \"0\")\n        // These are common in HTML attributes and should be treated as booleans\n        if (value === \"1\") return true;\n        if (value === \"0\") return false;\n        if (value === \"\") return true; // Empty string is truthy in HTML attributes\n\n        // Handle numeric strings (after boolean check to avoid conflicts)\n        // This ensures \"0\" is treated as boolean false, not number 0\n        if (!isNaN(value) && value !== \"\" && !isNaN(parseFloat(value))) {\n          return Number(value);\n        }\n\n        // Handle date strings (ISO format)\n        // Recognizes standard ISO date format and converts to Date object\n        if (value.match(/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}/)) {\n          const date = new Date(value);\n          if (!isNaN(date.getTime())) {\n            return date;\n          }\n        }\n\n        // Return as string if no other parsing applies\n        // This is the fallback for regular text strings\n        return value;\n      } catch (error) {\n        // Call error handler if provided\n        if (onError) {\n          onError(error, value);\n        }\n        // Fallback to original value to prevent breaking the application\n        return value;\n      }\n    };\n\n    /**\n     * Enhanced props extraction with automatic type detection\n     * @private\n     * @param {HTMLElement} element - The DOM element to extract props from\n     * @returns {Object} Object containing parsed props with appropriate types\n     *\n     * @description\n     * Extracts props from DOM element attributes that start with \":\" and automatically\n     * parses them to their appropriate types. Removes the attributes from the element\n     * after extraction.\n     *\n     * @example\n     * // HTML: <div :name=\"John\" :age=\"30\" :active=\"true\" :data='{\"key\": \"value\"}'></div>\n     * const props = extractProps(element);\n     * // Result: { name: \"John\", age: 30, active: true, data: {key: \"value\"} }\n     */\n    const extractProps = (element) => {\n      const props = {};\n      const attrs = element.attributes;\n\n      // Iterate through attributes in reverse order to handle removal correctly\n      for (let i = attrs.length - 1; i >= 0; i--) {\n        const attr = attrs[i];\n        // Only process attributes that start with \":\" (prop attributes)\n        if (attr.name.startsWith(\":\")) {\n          const propName = attr.name.slice(1); // Remove the \":\" prefix\n          // Parse the value if auto-parsing is enabled, otherwise use as-is\n          const parsedValue = enableAutoParsing\n            ? parsePropValue(attr.value)\n            : attr.value;\n          props[propName] = parsedValue;\n          // Remove the attribute from the DOM element after extraction\n          element.removeAttribute(attr.name);\n        }\n      }\n\n      return props;\n    };\n\n    /**\n     * Creates reactive props using Eleva's signal system\n     * @private\n     * @param {Object} props - The props object to make reactive\n     * @returns {Object} Object containing reactive props (Eleva signals)\n     *\n     * @description\n     * Converts regular prop values into Eleva signals for reactive updates.\n     * If a value is already a signal, it's passed through unchanged.\n     *\n     * @example\n     * const props = { name: \"John\", age: 30, active: true };\n     * const reactiveProps = createReactiveProps(props);\n     * // Result: {\n     * //   name: Signal(\"John\"),\n     * //   age: Signal(30),\n     * //   active: Signal(true)\n     * // }\n     */\n    const createReactiveProps = (props) => {\n      const reactiveProps = {};\n\n      // Convert each prop value to a reactive signal\n      Object.entries(props).forEach(([key, value]) => {\n        // Check if value is already a signal (has 'value' and 'watch' properties)\n        if (\n          value &&\n          typeof value === \"object\" &&\n          \"value\" in value &&\n          \"watch\" in value\n        ) {\n          // Value is already a signal, use it as-is\n          reactiveProps[key] = value;\n        } else {\n          // Create new signal for the prop value to make it reactive\n          reactiveProps[key] = new eleva.signal(value);\n        }\n      });\n\n      return reactiveProps;\n    };\n\n    // Override Eleva's internal _extractProps method with our enhanced version\n    eleva._extractProps = extractProps;\n\n    // Override Eleva's mount method to apply enhanced prop handling\n    const originalMount = eleva.mount;\n    eleva.mount = async (container, compName, props = {}) => {\n      // Create reactive props if reactivity is enabled\n      const enhancedProps = enableReactivity\n        ? createReactiveProps(props)\n        : props;\n\n      // Call the original mount method with enhanced props\n      return await originalMount.call(\n        eleva,\n        container,\n        compName,\n        enhancedProps\n      );\n    };\n\n    // Override Eleva's _mountComponents method to enable signal reference passing\n    const originalMountComponents = eleva._mountComponents;\n\n    // Cache to store parent contexts by container element\n    const parentContextCache = new WeakMap();\n    // Store child instances that need signal linking\n    const pendingSignalLinks = new Set();\n\n    eleva._mountComponents = async (container, children, childInstances) => {\n      for (const [selector, component] of Object.entries(children)) {\n        if (!selector) continue;\n        for (const el of container.querySelectorAll(selector)) {\n          if (!(el instanceof HTMLElement)) continue;\n\n          // Extract props from DOM attributes\n          const extractedProps = eleva._extractProps(el);\n\n          // Get parent context to check for signal references\n          let enhancedProps = extractedProps;\n\n          // Try to find parent context by looking up the DOM tree\n          let parentContext = parentContextCache.get(container);\n          if (!parentContext) {\n            let currentElement = container;\n            while (currentElement && !parentContext) {\n              if (\n                currentElement._eleva_instance &&\n                currentElement._eleva_instance.data\n              ) {\n                parentContext = currentElement._eleva_instance.data;\n                // Cache the parent context for future use\n                parentContextCache.set(container, parentContext);\n                break;\n              }\n              currentElement = currentElement.parentElement;\n            }\n          }\n\n          if (enableReactivity && parentContext) {\n            const signalProps = {};\n\n            // Check each extracted prop to see if there's a matching signal in parent context\n            Object.keys(extractedProps).forEach((propName) => {\n              if (\n                parentContext[propName] &&\n                parentContext[propName] instanceof eleva.signal\n              ) {\n                // Found a signal in parent context with the same name as the prop\n                // Pass the signal reference instead of creating a new one\n                signalProps[propName] = parentContext[propName];\n              }\n            });\n\n            // Merge signal props with regular props (signal props take precedence)\n            enhancedProps = {\n              ...extractedProps,\n              ...signalProps,\n            };\n          }\n\n          // Create reactive props for non-signal props only\n          let finalProps = enhancedProps;\n          if (enableReactivity) {\n            // Only create reactive props for values that aren't already signals\n            const nonSignalProps = {};\n            Object.entries(enhancedProps).forEach(([key, value]) => {\n              if (\n                !(\n                  value &&\n                  typeof value === \"object\" &&\n                  \"value\" in value &&\n                  \"watch\" in value\n                )\n              ) {\n                // This is not a signal, create a reactive prop for it\n                nonSignalProps[key] = value;\n              }\n            });\n\n            // Create reactive props only for non-signal values\n            const reactiveNonSignalProps = createReactiveProps(nonSignalProps);\n\n            // Merge signal props with reactive non-signal props\n            finalProps = {\n              ...reactiveNonSignalProps,\n              ...enhancedProps, // Signal props take precedence\n            };\n          }\n\n          /** @type {MountResult} */\n          const instance = await eleva.mount(el, component, finalProps);\n          if (instance && !childInstances.includes(instance)) {\n            childInstances.push(instance);\n\n            // If we have extracted props but no parent context yet, mark for later signal linking\n            if (\n              enableReactivity &&\n              Object.keys(extractedProps).length > 0 &&\n              !parentContext\n            ) {\n              pendingSignalLinks.add({\n                instance,\n                extractedProps,\n                container,\n                component,\n              });\n            }\n          }\n        }\n      }\n\n      // After mounting all children, try to link signals for pending instances\n      if (enableReactivity && pendingSignalLinks.size > 0) {\n        for (const pending of pendingSignalLinks) {\n          const { instance, extractedProps, container, component } = pending;\n\n          // Try to find parent context again\n          let parentContext = parentContextCache.get(container);\n          if (!parentContext) {\n            let currentElement = container;\n            while (currentElement && !parentContext) {\n              if (\n                currentElement._eleva_instance &&\n                currentElement._eleva_instance.data\n              ) {\n                parentContext = currentElement._eleva_instance.data;\n                parentContextCache.set(container, parentContext);\n                break;\n              }\n              currentElement = currentElement.parentElement;\n            }\n          }\n\n          if (parentContext) {\n            const signalProps = {};\n\n            // Check each extracted prop to see if there's a matching signal in parent context\n            Object.keys(extractedProps).forEach((propName) => {\n              if (\n                parentContext[propName] &&\n                parentContext[propName] instanceof eleva.signal\n              ) {\n                signalProps[propName] = parentContext[propName];\n              }\n            });\n\n            // Update the child instance's data with signal references\n            if (Object.keys(signalProps).length > 0) {\n              Object.assign(instance.data, signalProps);\n\n              // Set up signal watchers for the newly linked signals\n              Object.keys(signalProps).forEach((propName) => {\n                const signal = signalProps[propName];\n                if (signal && typeof signal.watch === \"function\") {\n                  signal.watch((newValue) => {\n                    // Trigger a re-render of the child component when the signal changes\n                    const childComponent =\n                      eleva._components.get(component) || component;\n                    if (childComponent && childComponent.template) {\n                      const templateResult =\n                        typeof childComponent.template === \"function\"\n                          ? childComponent.template(instance.data)\n                          : childComponent.template;\n                      const newHtml = TemplateEngine.parse(\n                        templateResult,\n                        instance.data\n                      );\n                      eleva.renderer.patchDOM(instance.container, newHtml);\n                    }\n                  });\n                }\n              });\n\n              // Initial re-render to show the correct signal values\n              const childComponent =\n                eleva._components.get(component) || component;\n              if (childComponent && childComponent.template) {\n                const templateResult =\n                  typeof childComponent.template === \"function\"\n                    ? childComponent.template(instance.data)\n                    : childComponent.template;\n                const newHtml = TemplateEngine.parse(\n                  templateResult,\n                  instance.data\n                );\n                eleva.renderer.patchDOM(instance.container, newHtml);\n              }\n            }\n\n            // Remove from pending list\n            pendingSignalLinks.delete(pending);\n          }\n        }\n      }\n    };\n\n    /**\n     * Expose utility methods on the Eleva instance\n     * @namespace eleva.props\n     */\n    eleva.props = {\n      /**\n       * Parse a single value with automatic type detection\n       * @param {any} value - The value to parse\n       * @returns {any} The parsed value with appropriate type\n       *\n       * @example\n       * app.props.parse(\"42\")             // â†’ 42\n       * app.props.parse(\"true\")           // â†’ true\n       * app.props.parse('{\"key\": \"val\"}') // â†’ {key: \"val\"}\n       */\n      parse: (value) => {\n        // Return value as-is if auto parsing is disabled\n        if (!enableAutoParsing) {\n          return value;\n        }\n        // Use our enhanced parsing function\n        return parsePropValue(value);\n      },\n\n      /**\n       * Detect the type of a value\n       * @param {any} value - The value to detect type for\n       * @returns {string} The detected type\n       *\n       * @example\n       * app.props.detectType(\"hello\")     // â†’ \"string\"\n       * app.props.detectType(42)          // â†’ \"number\"\n       * app.props.detectType([1, 2, 3])   // â†’ \"array\"\n       */\n      detectType,\n    };\n\n    // Store original methods for uninstall\n    eleva._originalExtractProps = eleva._extractProps;\n    eleva._originalMount = originalMount;\n    eleva._originalMountComponents = originalMountComponents;\n  },\n\n  /**\n   * Uninstalls the plugin from the Eleva instance\n   *\n   * @param {Object} eleva - The Eleva instance\n   *\n   * @description\n   * Restores the original Eleva methods and removes all plugin-specific\n   * functionality. This method should be called when the plugin is no\n   * longer needed.\n   *\n   * @example\n   * // Uninstall the plugin\n   * PropsPlugin.uninstall(app);\n   */\n  uninstall(eleva) {\n    // Restore original _extractProps method\n    if (eleva._originalExtractProps) {\n      eleva._extractProps = eleva._originalExtractProps;\n      delete eleva._originalExtractProps;\n    }\n\n    // Restore original mount method\n    if (eleva._originalMount) {\n      eleva.mount = eleva._originalMount;\n      delete eleva._originalMount;\n    }\n\n    // Restore original _mountComponents method\n    if (eleva._originalMountComponents) {\n      eleva._mountComponents = eleva._originalMountComponents;\n      delete eleva._originalMountComponents;\n    }\n\n    // Remove plugin utility methods\n    if (eleva.props) {\n      delete eleva.props;\n    }\n  },\n};\n","\"use strict\";\n\n/**\n * @class ðŸª StorePlugin\n * @classdesc A powerful reactive state management plugin for Eleva.js that enables sharing\n * reactive data across the entire application. The Store plugin provides a centralized,\n * reactive data store that can be accessed from any component's setup function.\n *\n * Core Features:\n * - Centralized reactive state management using Eleva's signal system\n * - Global state accessibility through component setup functions\n * - Namespace support for organizing store modules\n * - Built-in persistence with localStorage/sessionStorage support\n * - Action-based state mutations with validation\n * - Subscription system for reactive updates\n * - DevTools integration for debugging\n * - Plugin architecture for extensibility\n *\n * @example\n * // Install the plugin\n * const app = new Eleva(\"myApp\");\n * app.use(StorePlugin, {\n *   state: {\n *     user: { name: \"John\", email: \"john@example.com\" },\n *     counter: 0,\n *     todos: []\n *   },\n *   actions: {\n *     increment: (state) => state.counter.value++,\n *     addTodo: (state, todo) => state.todos.value.push(todo),\n *     setUser: (state, user) => state.user.value = user\n *   },\n *   persistence: {\n *     enabled: true,\n *     key: \"myApp-store\",\n *     storage: \"localStorage\"\n *   }\n * });\n *\n * // Use store in components\n * app.component(\"Counter\", {\n *   setup({ store }) {\n *     return {\n *       count: store.state.counter,\n *       increment: () => store.dispatch(\"increment\"),\n *       user: store.state.user\n *     };\n *   },\n *   template: (ctx) => `\n *     <div>\n *       <p>Hello ${ctx.user.value.name}!</p>\n *       <p>Count: ${ctx.count.value}</p>\n *       <button onclick=\"ctx.increment()\">+</button>\n *     </div>\n *   `\n * });\n */\nexport const StorePlugin = {\n  /**\n   * Unique identifier for the plugin\n   * @type {string}\n   */\n  name: \"store\",\n\n  /**\n   * Plugin version\n   * @type {string}\n   */\n  version: \"1.0.0-rc.10\",\n\n  /**\n   * Plugin description\n   * @type {string}\n   */\n  description:\n    \"Reactive state management for sharing data across the entire Eleva application\",\n\n  /**\n   * Installs the plugin into the Eleva instance\n   *\n   * @param {Object} eleva - The Eleva instance\n   * @param {Object} options - Plugin configuration options\n   * @param {Object} [options.state={}] - Initial state object\n   * @param {Object} [options.actions={}] - Action functions for state mutations\n   * @param {Object} [options.namespaces={}] - Namespaced modules for organizing store\n   * @param {Object} [options.persistence] - Persistence configuration\n   * @param {boolean} [options.persistence.enabled=false] - Enable state persistence\n   * @param {string} [options.persistence.key=\"eleva-store\"] - Storage key\n   * @param {\"localStorage\" | \"sessionStorage\"} [options.persistence.storage=\"localStorage\"] - Storage type\n   * @param {Array<string>} [options.persistence.include] - State keys to persist (if not provided, all state is persisted)\n   * @param {Array<string>} [options.persistence.exclude] - State keys to exclude from persistence\n   * @param {boolean} [options.devTools=false] - Enable development tools integration\n   * @param {Function} [options.onError=null] - Error handler function\n   *\n   * @example\n   * // Basic installation\n   * app.use(StorePlugin, {\n   *   state: { count: 0, user: null },\n   *   actions: {\n   *     increment: (state) => state.count.value++,\n   *     setUser: (state, user) => state.user.value = user\n   *   }\n   * });\n   *\n   * // Advanced installation with persistence and namespaces\n   * app.use(StorePlugin, {\n   *   state: { theme: \"light\" },\n   *   namespaces: {\n   *     auth: {\n   *       state: { user: null, token: null },\n   *       actions: {\n   *         login: (state, { user, token }) => {\n   *           state.user.value = user;\n   *           state.token.value = token;\n   *         },\n   *         logout: (state) => {\n   *           state.user.value = null;\n   *           state.token.value = null;\n   *         }\n   *       }\n   *     }\n   *   },\n   *   persistence: {\n   *     enabled: true,\n   *     include: [\"theme\", \"auth.user\"]\n   *   }\n   * });\n   */\n  install(eleva, options = {}) {\n    const {\n      state = {},\n      actions = {},\n      namespaces = {},\n      persistence = {},\n      devTools = false,\n      onError = null,\n    } = options;\n\n    /**\n     * Store instance that manages all state and provides the API\n     * @private\n     */\n    class Store {\n      constructor() {\n        this.state = {};\n        this.actions = {};\n        this.subscribers = new Set();\n        this.mutations = [];\n        this.persistence = {\n          enabled: false,\n          key: \"eleva-store\",\n          storage: \"localStorage\",\n          include: null,\n          exclude: null,\n          ...persistence,\n        };\n        this.devTools = devTools;\n        this.onError = onError;\n\n        this._initializeState(state, actions);\n        this._initializeNamespaces(namespaces);\n        this._loadPersistedState();\n        this._setupDevTools();\n      }\n\n      /**\n       * Initializes the root state and actions\n       * @private\n       */\n      _initializeState(initialState, initialActions) {\n        // Create reactive signals for each state property\n        Object.entries(initialState).forEach(([key, value]) => {\n          this.state[key] = new eleva.signal(value);\n        });\n\n        // Set up actions\n        this.actions = { ...initialActions };\n      }\n\n      /**\n       * Initializes namespaced modules\n       * @private\n       */\n      _initializeNamespaces(namespaces) {\n        Object.entries(namespaces).forEach(([namespace, module]) => {\n          const { state: moduleState = {}, actions: moduleActions = {} } =\n            module;\n\n          // Create namespace object if it doesn't exist\n          if (!this.state[namespace]) {\n            this.state[namespace] = {};\n          }\n          if (!this.actions[namespace]) {\n            this.actions[namespace] = {};\n          }\n\n          // Initialize namespaced state\n          Object.entries(moduleState).forEach(([key, value]) => {\n            this.state[namespace][key] = new eleva.signal(value);\n          });\n\n          // Set up namespaced actions\n          this.actions[namespace] = { ...moduleActions };\n        });\n      }\n\n      /**\n       * Loads persisted state from storage\n       * @private\n       */\n      _loadPersistedState() {\n        if (!this.persistence.enabled || typeof window === \"undefined\") {\n          return;\n        }\n\n        try {\n          const storage = window[this.persistence.storage];\n          const persistedData = storage.getItem(this.persistence.key);\n\n          if (persistedData) {\n            const data = JSON.parse(persistedData);\n            this._applyPersistedData(data);\n          }\n        } catch (error) {\n          if (this.onError) {\n            this.onError(error, \"Failed to load persisted state\");\n          } else {\n            console.warn(\n              \"[StorePlugin] Failed to load persisted state:\",\n              error\n            );\n          }\n        }\n      }\n\n      /**\n       * Applies persisted data to the current state\n       * @private\n       */\n      _applyPersistedData(data, currentState = this.state, path = \"\") {\n        Object.entries(data).forEach(([key, value]) => {\n          const fullPath = path ? `${path}.${key}` : key;\n\n          if (this._shouldPersist(fullPath)) {\n            if (\n              currentState[key] &&\n              typeof currentState[key] === \"object\" &&\n              \"value\" in currentState[key]\n            ) {\n              // This is a signal, update its value\n              currentState[key].value = value;\n            } else if (\n              typeof value === \"object\" &&\n              value !== null &&\n              currentState[key]\n            ) {\n              // This is a nested object, recurse\n              this._applyPersistedData(value, currentState[key], fullPath);\n            }\n          }\n        });\n      }\n\n      /**\n       * Determines if a state path should be persisted\n       * @private\n       */\n      _shouldPersist(path) {\n        const { include, exclude } = this.persistence;\n\n        if (include && include.length > 0) {\n          return include.some((includePath) => path.startsWith(includePath));\n        }\n\n        if (exclude && exclude.length > 0) {\n          return !exclude.some((excludePath) => path.startsWith(excludePath));\n        }\n\n        return true;\n      }\n\n      /**\n       * Saves current state to storage\n       * @private\n       */\n      _saveState() {\n        if (!this.persistence.enabled || typeof window === \"undefined\") {\n          return;\n        }\n\n        try {\n          const storage = window[this.persistence.storage];\n          const dataToSave = this._extractPersistedData();\n          storage.setItem(this.persistence.key, JSON.stringify(dataToSave));\n        } catch (error) {\n          if (this.onError) {\n            this.onError(error, \"Failed to save state\");\n          } else {\n            console.warn(\"[StorePlugin] Failed to save state:\", error);\n          }\n        }\n      }\n\n      /**\n       * Extracts data that should be persisted\n       * @private\n       */\n      _extractPersistedData(currentState = this.state, path = \"\") {\n        const result = {};\n\n        Object.entries(currentState).forEach(([key, value]) => {\n          const fullPath = path ? `${path}.${key}` : key;\n\n          if (this._shouldPersist(fullPath)) {\n            if (value && typeof value === \"object\" && \"value\" in value) {\n              // This is a signal, extract its value\n              result[key] = value.value;\n            } else if (typeof value === \"object\" && value !== null) {\n              // This is a nested object, recurse\n              const nestedData = this._extractPersistedData(value, fullPath);\n              if (Object.keys(nestedData).length > 0) {\n                result[key] = nestedData;\n              }\n            }\n          }\n        });\n\n        return result;\n      }\n\n      /**\n       * Sets up development tools integration\n       * @private\n       */\n      _setupDevTools() {\n        if (\n          !this.devTools ||\n          typeof window === \"undefined\" ||\n          !window.__ELEVA_DEVTOOLS__\n        ) {\n          return;\n        }\n\n        window.__ELEVA_DEVTOOLS__.registerStore(this);\n      }\n\n      /**\n       * Dispatches an action to mutate the state\n       * @param {string} actionName - The name of the action to dispatch (supports namespaced actions like \"auth.login\")\n       * @param {any} payload - The payload to pass to the action\n       * @returns {Promise<any>} The result of the action\n       */\n      async dispatch(actionName, payload) {\n        try {\n          const action = this._getAction(actionName);\n\n          if (!action) {\n            const error = new Error(`Action \"${actionName}\" not found`);\n            if (this.onError) {\n              this.onError(error, actionName);\n            }\n            throw error;\n          }\n\n          const mutation = {\n            type: actionName,\n            payload,\n            timestamp: Date.now(),\n          };\n\n          // Record mutation for devtools\n          this.mutations.push(mutation);\n          if (this.mutations.length > 100) {\n            this.mutations.shift(); // Keep only last 100 mutations\n          }\n\n          // Execute the action\n          const result = await action.call(null, this.state, payload);\n\n          // Save state if persistence is enabled\n          this._saveState();\n\n          // Notify subscribers\n          this.subscribers.forEach((callback) => {\n            try {\n              callback(mutation, this.state);\n            } catch (error) {\n              if (this.onError) {\n                this.onError(error, \"Subscriber callback failed\");\n              }\n            }\n          });\n\n          // Notify devtools\n          if (\n            this.devTools &&\n            typeof window !== \"undefined\" &&\n            window.__ELEVA_DEVTOOLS__\n          ) {\n            window.__ELEVA_DEVTOOLS__.notifyMutation(mutation, this.state);\n          }\n\n          return result;\n        } catch (error) {\n          if (this.onError) {\n            this.onError(error, `Action dispatch failed: ${actionName}`);\n          }\n          throw error;\n        }\n      }\n\n      /**\n       * Gets an action by name (supports namespaced actions)\n       * @private\n       */\n      _getAction(actionName) {\n        const parts = actionName.split(\".\");\n        let current = this.actions;\n\n        for (const part of parts) {\n          if (current[part] === undefined) {\n            return null;\n          }\n          current = current[part];\n        }\n\n        return typeof current === \"function\" ? current : null;\n      }\n\n      /**\n       * Subscribes to store mutations\n       * @param {Function} callback - Callback function to call on mutations\n       * @returns {Function} Unsubscribe function\n       */\n      subscribe(callback) {\n        if (typeof callback !== \"function\") {\n          throw new Error(\"Subscribe callback must be a function\");\n        }\n\n        this.subscribers.add(callback);\n\n        // Return unsubscribe function\n        return () => {\n          this.subscribers.delete(callback);\n        };\n      }\n\n      /**\n       * Gets a deep copy of the current state values (not signals)\n       * @returns {Object} The current state values\n       */\n      getState() {\n        return this._extractPersistedData();\n      }\n\n      /**\n       * Replaces the entire state (useful for testing or state hydration)\n       * @param {Object} newState - The new state object\n       */\n      replaceState(newState) {\n        this._applyPersistedData(newState);\n        this._saveState();\n      }\n\n      /**\n       * Clears persisted state from storage\n       */\n      clearPersistedState() {\n        if (!this.persistence.enabled || typeof window === \"undefined\") {\n          return;\n        }\n\n        try {\n          const storage = window[this.persistence.storage];\n          storage.removeItem(this.persistence.key);\n        } catch (error) {\n          if (this.onError) {\n            this.onError(error, \"Failed to clear persisted state\");\n          }\n        }\n      }\n\n      /**\n       * Registers a new namespaced module at runtime\n       * @param {string} namespace - The namespace for the module\n       * @param {Object} module - The module definition\n       * @param {Object} module.state - The module's initial state\n       * @param {Object} module.actions - The module's actions\n       */\n      registerModule(namespace, module) {\n        if (this.state[namespace] || this.actions[namespace]) {\n          console.warn(`[StorePlugin] Module \"${namespace}\" already exists`);\n          return;\n        }\n\n        // Initialize the module\n        this.state[namespace] = {};\n        this.actions[namespace] = {};\n\n        const namespaces = { [namespace]: module };\n        this._initializeNamespaces(namespaces);\n\n        this._saveState();\n      }\n\n      /**\n       * Unregisters a namespaced module\n       * @param {string} namespace - The namespace to unregister\n       */\n      unregisterModule(namespace) {\n        if (!this.state[namespace] && !this.actions[namespace]) {\n          console.warn(`[StorePlugin] Module \"${namespace}\" does not exist`);\n          return;\n        }\n\n        delete this.state[namespace];\n        delete this.actions[namespace];\n        this._saveState();\n      }\n\n      /**\n       * Creates a new reactive state property at runtime\n       * @param {string} key - The state key\n       * @param {*} initialValue - The initial value\n       * @returns {Object} The created signal\n       */\n      createState(key, initialValue) {\n        if (this.state[key]) {\n          return this.state[key]; // Return existing state\n        }\n\n        this.state[key] = new eleva.signal(initialValue);\n        this._saveState();\n        return this.state[key];\n      }\n\n      /**\n       * Creates a new action at runtime\n       * @param {string} name - The action name\n       * @param {Function} actionFn - The action function\n       */\n      createAction(name, actionFn) {\n        if (typeof actionFn !== \"function\") {\n          throw new Error(\"Action must be a function\");\n        }\n\n        this.actions[name] = actionFn;\n      }\n    }\n\n    // Create the store instance\n    const store = new Store();\n\n    // Store the original mount method to override it\n    const originalMount = eleva.mount;\n\n    /**\n     * Override the mount method to inject store context into components\n     */\n    eleva.mount = async (container, compName, props = {}) => {\n      // Get the component definition\n      const componentDef =\n        typeof compName === \"string\"\n          ? eleva._components.get(compName) || compName\n          : compName;\n\n      if (!componentDef) {\n        return await originalMount.call(eleva, container, compName, props);\n      }\n\n      // Create a wrapped component that injects store into setup\n      const wrappedComponent = {\n        ...componentDef,\n        async setup(ctx) {\n          // Inject store into the context with enhanced API\n          ctx.store = {\n            // Core store functionality\n            state: store.state,\n            dispatch: store.dispatch.bind(store),\n            subscribe: store.subscribe.bind(store),\n            getState: store.getState.bind(store),\n\n            // Module management\n            registerModule: store.registerModule.bind(store),\n            unregisterModule: store.unregisterModule.bind(store),\n\n            // Utilities for dynamic state/action creation\n            createState: store.createState.bind(store),\n            createAction: store.createAction.bind(store),\n\n            // Access to signal constructor for manual state creation\n            signal: eleva.signal,\n          };\n\n          // Call original setup if it exists\n          const originalSetup = componentDef.setup;\n          const result = originalSetup ? await originalSetup(ctx) : {};\n\n          return result;\n        },\n      };\n\n      // Call original mount with wrapped component\n      return await originalMount.call(\n        eleva,\n        container,\n        wrappedComponent,\n        props\n      );\n    };\n\n    // Override _mountComponents to ensure child components also get store context\n    const originalMountComponents = eleva._mountComponents;\n    eleva._mountComponents = async (container, children, childInstances) => {\n      // Create wrapped children with store injection\n      const wrappedChildren = {};\n\n      for (const [selector, childComponent] of Object.entries(children)) {\n        const componentDef =\n          typeof childComponent === \"string\"\n            ? eleva._components.get(childComponent) || childComponent\n            : childComponent;\n\n        if (componentDef && typeof componentDef === \"object\") {\n          wrappedChildren[selector] = {\n            ...componentDef,\n            async setup(ctx) {\n              // Inject store into the context with enhanced API\n              ctx.store = {\n                // Core store functionality\n                state: store.state,\n                dispatch: store.dispatch.bind(store),\n                subscribe: store.subscribe.bind(store),\n                getState: store.getState.bind(store),\n\n                // Module management\n                registerModule: store.registerModule.bind(store),\n                unregisterModule: store.unregisterModule.bind(store),\n\n                // Utilities for dynamic state/action creation\n                createState: store.createState.bind(store),\n                createAction: store.createAction.bind(store),\n\n                // Access to signal constructor for manual state creation\n                signal: eleva.signal,\n              };\n\n              // Call original setup if it exists\n              const originalSetup = componentDef.setup;\n              const result = originalSetup ? await originalSetup(ctx) : {};\n\n              return result;\n            },\n          };\n        } else {\n          wrappedChildren[selector] = childComponent;\n        }\n      }\n\n      // Call original _mountComponents with wrapped children\n      return await originalMountComponents.call(\n        eleva,\n        container,\n        wrappedChildren,\n        childInstances\n      );\n    };\n\n    // Expose store instance and utilities on the Eleva instance\n    eleva.store = store;\n\n    /**\n     * Expose utility methods on the Eleva instance\n     * @namespace eleva.store\n     */\n    eleva.createAction = (name, actionFn) => {\n      store.actions[name] = actionFn;\n    };\n\n    eleva.dispatch = (actionName, payload) => {\n      return store.dispatch(actionName, payload);\n    };\n\n    eleva.getState = () => {\n      return store.getState();\n    };\n\n    eleva.subscribe = (callback) => {\n      return store.subscribe(callback);\n    };\n\n    // Store original methods for cleanup\n    eleva._originalMount = originalMount;\n    eleva._originalMountComponents = originalMountComponents;\n  },\n\n  /**\n   * Uninstalls the plugin from the Eleva instance\n   *\n   * @param {Object} eleva - The Eleva instance\n   *\n   * @description\n   * Restores the original Eleva methods and removes all plugin-specific\n   * functionality. This method should be called when the plugin is no\n   * longer needed.\n   *\n   * @example\n   * // Uninstall the plugin\n   * StorePlugin.uninstall(app);\n   */\n  uninstall(eleva) {\n    // Restore original mount method\n    if (eleva._originalMount) {\n      eleva.mount = eleva._originalMount;\n      delete eleva._originalMount;\n    }\n\n    // Restore original _mountComponents method\n    if (eleva._originalMountComponents) {\n      eleva._mountComponents = eleva._originalMountComponents;\n      delete eleva._originalMountComponents;\n    }\n\n    // Remove store instance and utility methods\n    if (eleva.store) {\n      delete eleva.store;\n    }\n    if (eleva.createAction) {\n      delete eleva.createAction;\n    }\n    if (eleva.dispatch) {\n      delete eleva.dispatch;\n    }\n    if (eleva.getState) {\n      delete eleva.getState;\n    }\n    if (eleva.subscribe) {\n      delete eleva.subscribe;\n    }\n  },\n};\n"],"names":["CAMEL_RE","AttrPlugin","name","version","description","install","eleva","options","enableAria","enableData","enableBoolean","enableDynamic","updateAttributes","oldEl","newEl","oldAttrs","attributes","newAttrs","i","length","value","startsWith","getAttribute","prop","slice","replace","_","l","toUpperCase","setAttribute","dataset","Object","getOwnPropertyDescriptor","getPrototypeOf","elementProps","getOwnPropertyNames","matchingProp","find","p","toLowerCase","includes","descriptor","hasProperty","isBoolean","get","call","boolValue","removeAttribute","hasAttribute","renderer","originalPatchNode","_patchNode","_originalPatchNode","oldNode","newNode","_eleva_instance","_isSameNode","replaceWith","cloneNode","nodeType","Node","ELEMENT_NODE","_diff","TEXT_NODE","nodeValue","plugins","Map","set","updateElementAttributes","uninstall","delete","CoreErrorHandler","handle","error","context","details","message","formattedError","Error","originalError","console","warn","log","Router","constructor","mode","queryParam","viewSelector","routes","_processRoutes","emitter","isStarted","_isNavigating","_navigationId","eventListeners","currentRoute","signal","previousRoute","currentParams","currentQuery","currentLayout","currentView","isReady","_beforeEachGuards","onBeforeEach","push","errorHandler","_scrollPositions","_validateOptions","processedRoutes","route","segments","_parsePathIntoSegments","path","normalizedPath","split","filter","Boolean","map","segment","paramName","substring","type","_findViewElement","container","selector","querySelector","start","window","document","mount","mountSelector","handler","_handleRouteChange","addEventListener","removeEventListener","emit","destroy","plugin","values","forEach","cleanup","unmount","stop","navigate","location","params","target","_buildPath","query","keys","queryString","URLSearchParams","toString","_isSameRoute","navigationSuccessful","_proceedWithNavigation","currentNavId","state","historyMethod","newUrl","pathname","search","history","replaceState","hash","url","_buildQueryUrl","queueMicrotask","urlParams","current","targetPath","targetQuery","_parseQuery","JSON","stringify","result","key","entries","encodedValue","encodeURIComponent","String","RegExp","isPopState","from","toLocation","_getCurrentLocation","fullUrl","currentUrl","href","fullPath","toMatch","_matchRoute","notFoundRoute","pathMatch","decodeURIComponent","to","meta","matched","canNavigate","_runGuards","x","scrollX","pageXOffset","y","scrollY","pageYOffset","resolveContext","layoutComponent","pageComponent","cancelled","redirectTo","_resolveComponents","toLayout","layout","globalLayout","fromLayout","tryUnmount","instance","afterLeave","renderContext","_render","scrollContext","savedPosition","afterEnter","navContext","guards","beforeLeave","beforeEnter","guard","_resolveStringComponent","def","componentDef","_components","componentName","availableComponents","Array","_resolveFunctionComponent","funcStr","isAsyncImport","default","function","_validateComponentDefinition","definition","template","_resolveComponent","undefined","effectiveLayout","Promise","all","component","mountEl","layoutInstance","_wrapComponentWithChildren","viewEl","viewInstance","_createRouteGetter","property","defaultValue","_wrapComponent","originalSetup","setup","self","ctx","router","bind","previous","wrappedComponent","children","wrappedChildren","childComponent","pathSegments","isMatch","routeSegment","pathSegment","addRoute","parentRoute","hasRoute","processedRoute","wildcardIndex","findIndex","r","splice","removeRoute","index","removedRoute","some","getRoutes","getRoute","indexOf","onAfterEnter","hook","on","onAfterLeave","onAfterEach","onError","use","has","existingPlugin","getPlugins","getPlugin","removePlugin","setErrorHandler","RouterPlugin","isArray","register","Math","random","autoStart","getCurrentRoute","getRouteParams","getRouteQuery","TemplateEngine","expressionPattern","parse","data","expression","evaluate","Function","PropsPlugin","enableAutoParsing","enableReactivity","detectType","Date","Set","parsePropValue","e","isNaN","parseFloat","Number","match","date","getTime","extractProps","element","props","attrs","attr","propName","parsedValue","createReactiveProps","reactiveProps","_extractProps","originalMount","compName","enhancedProps","originalMountComponents","_mountComponents","parentContextCache","WeakMap","pendingSignalLinks","childInstances","el","querySelectorAll","HTMLElement","extractedProps","parentContext","currentElement","parentElement","signalProps","finalProps","nonSignalProps","reactiveNonSignalProps","add","size","pending","assign","watch","newValue","templateResult","newHtml","patchDOM","_originalExtractProps","_originalMount","_originalMountComponents","StorePlugin","actions","namespaces","persistence","devTools","Store","subscribers","mutations","enabled","storage","include","exclude","_initializeState","_initializeNamespaces","_loadPersistedState","_setupDevTools","initialState","initialActions","namespace","module","moduleState","moduleActions","persistedData","getItem","_applyPersistedData","currentState","_shouldPersist","includePath","excludePath","_saveState","dataToSave","_extractPersistedData","setItem","nestedData","__ELEVA_DEVTOOLS__","registerStore","dispatch","actionName","payload","action","_getAction","mutation","timestamp","now","shift","callback","notifyMutation","parts","part","subscribe","getState","newState","clearPersistedState","removeItem","registerModule","unregisterModule","createState","initialValue","createAction","actionFn","store"],"mappings":"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,IAAI,CAACA,IAAI;MACfC,OAAO,EAAE,IAAI,CAACA,OAAO;MACrBC,WAAW,EAAE,IAAI,CAACA,WAAW;AAC7BG,MAAAA;AACF,KAAC,CAAC;;AAEF;IACAD,KAAK,CAAC8D,uBAAuB,GAAGxD,gBAAgB;EAClD,CAAC;AAED;AACF;AACA;AACA;AACA;EACEyD,SAASA,CAAC/D,KAAK,EAAE;AACf;IACA,IAAIA,KAAK,CAAC2C,QAAQ,IAAI3C,KAAK,CAAC2C,QAAQ,CAACG,kBAAkB,EAAE;MACvD9C,KAAK,CAAC2C,QAAQ,CAACE,UAAU,GAAG7C,KAAK,CAAC2C,QAAQ,CAACG,kBAAkB;AAC7D,MAAA,OAAO9C,KAAK,CAAC2C,QAAQ,CAACG,kBAAkB;AAC1C,IAAA;;AAEA;IACA,IAAI9C,KAAK,CAAC2D,OAAO,EAAE;MACjB3D,KAAK,CAAC2D,OAAO,CAACK,MAAM,CAAC,IAAI,CAACpE,IAAI,CAAC;AACjC,IAAA;;AAEA;IACA,OAAOI,KAAK,CAAC8D,uBAAuB;AACtC,EAAA;AACF;;ACzPA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMG,gBAAgB,GAAG;AACvB;AACF;AACA;AACA;AACA;AACA;AACA;EACEC,MAAMA,CAACC,KAAK,EAAEC,OAAO,EAAEC,OAAO,GAAG,EAAE,EAAE;IACnC,MAAMC,OAAO,GAAG,CAAA,cAAA,EAAiBF,OAAO,KAAKD,KAAK,CAACG,OAAO,CAAA,CAAE;AAC5D,IAAA,MAAMC,cAAc,GAAG,IAAIC,KAAK,CAACF,OAAO,CAAC;;AAEzC;IACAC,cAAc,CAACE,aAAa,GAAGN,KAAK;IACpCI,cAAc,CAACH,OAAO,GAAGA,OAAO;IAChCG,cAAc,CAACF,OAAO,GAAGA,OAAO;AAEhCK,IAAAA,OAAO,CAACP,KAAK,CAACG,OAAO,EAAE;MAAEH,KAAK;MAAEC,OAAO;AAAEC,MAAAA;AAAQ,KAAC,CAAC;AACnD,IAAA,MAAME,cAAc;EACtB,CAAC;AAED;AACF;AACA;AACA;AACA;AACEI,EAAAA,IAAIA,CAACL,OAAO,EAAED,OAAO,GAAG,EAAE,EAAE;IAC1BK,OAAO,CAACC,IAAI,CAAC,CAAA,cAAA,EAAiBL,OAAO,CAAA,CAAE,EAAED,OAAO,CAAC;EACnD,CAAC;AAED;AACF;AACA;AACA;AACA;AACA;EACEO,GAAGA,CAACN,OAAO,EAAEH,KAAK,EAAEE,OAAO,GAAG,EAAE,EAAE;AAChCK,IAAAA,OAAO,CAACP,KAAK,CAAC,CAAA,cAAA,EAAiBG,OAAO,EAAE,EAAE;MAAEH,KAAK;AAAEE,MAAAA;AAAQ,KAAC,CAAC;AAC/D,EAAA;AACF,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMQ,MAAM,CAAC;AACX;AACF;AACA;AACA;AACA;AACEC,EAAAA,WAAWA,CAAC9E,KAAK,EAAEC,OAAO,GAAG,EAAE,EAAE;AAC/B;IACA,IAAI,CAACD,KAAK,GAAGA,KAAK;;AAElB;IACA,IAAI,CAACC,OAAO,GAAG;AACb8E,MAAAA,IAAI,EAAE,MAAM;AACZC,MAAAA,UAAU,EAAE,MAAM;AAClBC,MAAAA,YAAY,EAAE,MAAM;MACpB,GAAGhF;KACJ;;AAED;AACA,IAAA,IAAI,CAACiF,MAAM,GAAG,IAA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AAK,UAAU,EAAE;MACxC,IAAI;AACFC,QAAAA,MAAM,CAACD,OAAO,CAAC,IAAI,CAAC;MACtB,CAAC,CAAC,OAAOhE,KAAK,EAAE;QACd,IAAI,CAACiC,YAAY,CAACxB,GAAG,CAAC,UAAUhF,IAAI,CAAA,eAAA,CAAiB,EAAEuE,KAAK,CAAC;AAC/D,MAAA;AACF,IAAA;AAEA,IAAA,OAAO,IAAI,CAACR,OAAO,CAACK,MAAM,CAACpE,IAAI,CAAC;AAClC,EAAA;;AAEA;AACF;AACA;AACA;EACE4S,eAAeA,CAACpM,YAAY,EAAE;IAC5B,IACEA,YAAY,IACZ,OAAOA,YAAY,CAAClC,MAAM,KAAK,UAAU,IACzC,OAAOkC,YAAY,CAACzB,IAAI,KAAK,UAAU,IACvC,OAAOyB,YAAY,CAACxB,GAAG,KAAK,UAAU,EACtC;MACA,IAAI,CAACwB,YAAY,GAAGA,YAAY;AAClC,IAAA,CAAC,MAAM;AACL1B,MAAAA,OAAO,CAACC,IAAI,CACV,wFACF,CAAC;AACH,IAAA;AACF,EAAA;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAM8N,YAAY,GAAG;AAC1B;AACF;AACA;AACA;AACE7S,EAAAA,IAAI,EAAE,QAAQ;AAEd;AACF;AACA;AACA;AACEC,EAAAA,OAAO,EAAE,aAAa;AAEtB;AACF;AACA;AACA;AACEC,EAAAA,WAAW,EAAE,4CAA4C;AAEzD;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEC,EAAAA,OAAOA,CAACC,KAAK,EAAEC,OAAO,GAAG,EAAE,EAAE;AAC3B,I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,CAACpE,IAAI,CAAC;AACjC,IAAA;;AAEA;IACA,OAAOI,KAAK,CAAC0I,QAAQ;IACrB,OAAO1I,KAAK,CAAC+S,eAAe;IAC5B,OAAO/S,KAAK,CAACgT,cAAc;IAC3B,OAAOhT,KAAK,CAACiT,aAAa;AAC5B,EAAA;AACF;;AC53DA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMC,cAAc,CAAC;AAC1B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EACE,OAAOC,iBAAiB,GAAG,sBAAsB;;AAEjD;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACE,EAAA,OAAOC,KAAKA,CAACtE,QAAQ,EAAEuE,IAAI,EAAE;AAC3B,IAAA,IAAI,OAAOvE,QAAQ,KAAK,QAAQ,EAAE,OAAOA,QAAQ;IACjD,OAAOA,QAAQ,CAAC3N,OAAO,CAAC,IAAI,CAACgS,iBAAiB,EAAE,CAAC/R,CAAC,EAAEkS,UAAU,KAC5D,IAAI,CAACC,QAAQ,CAACD,UAAU,EAAED,IAAI,CAChC,CAAC;AACH,EAAA;;AAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACE,EAAA,OAAOE,QAAQA,CAACD,UAAU,EAAED,IAAI,EAAE;AAChC,IAAA,IAAI,OAAOC,UAAU,KAAK,QAAQ,EAAE,OAAOA,UAAU;IACrD,IAAI;MACF,OAAO,IAAIE,QAAQ,CAAC,MAAM,EAAE,CAAA,oBAAA,EAAuBF,UAAU,CAAA,GAAA,CAAK,CAAC,CAACD,IAAI,CAAC;AAC3E,IAAA,CAAC,CAAC,MAAM;AACN,MAAA,OAAO,EAAE;AACX,IAAA;AACF,EAAA;AACF;;ACxKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMI,WAAW,GAAG;AACzB;AACF;AACA;AACA;AACE7T,EAAAA,IAAI,EAAE,OAAO;AAEb;AACF;AACA;AACA;AACEC,EAAAA,OAAO,EAAE,aAAa;AAEtB;AACF;AACA;AACA;AACEC,EAAAA,WAAW,EACT,uGAAuG;AAEzG;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEC,EAAAA,OAAOA,CAACC,KAAK,EAAEC,OAAO,GAAG,EAAE,EAAE;IAC3B,MAAM;AACJyT,MAAAA,iBAAiB,GAAG,IAAI;AACxBC,MAAAA,gBAAgB,GAAG,IAAI;AACvB1B,MAAAA,OAAO,GAAG;AACZ,KAAC,GAAGhS,OAAO;;AAEX;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACI,MAAM2T,UAAU,GAAI9S,KAAK,IAAK;AAC5B,MAAA,IAAIA,KAAK,KAAK,IAAI,EAAE,OAAO,MAAM;AACjC,MAAA,IAAIA,KAAK,KAAKkO,SAAS,EAAE,OAAO,WAAW;AAC3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AA;AACF,EAAA;AACF;;AC3kBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMwC,WAAW,GAAG;AACzB;AACF;AACA;AACA;AACErX,EAAAA,IAAI,EAAE,OAAO;AAEb;AACF;AACA;AACA;AACEC,EAAAA,OAAO,EAAE,aAAa;AAEtB;AACF;AACA;AACA;AACEC,EAAAA,WAAW,EACT,gFAAgF;AAElF;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEC,EAAAA,OAAOA,CAACC,KAAK,EAAEC,OAAO,GAAG,EAAE,EAAE;IAC3B,MAAM;MACJuJ,KAAK,GAAG,EAAE;MACV0N,OAAO,GAAG,EAAE;MACZC,UAAU,GAAG,EAAE;MACfC,WAAW,GAAG,EAAE;AAChBC,MAAAA,QAAQ,GAAG,KAAK;AAChBpF,MAAAA,OAAO,GAAG;AACZ,KAAC,GAAGhS,OAAO;;AAEX;AACJ;AACA;AACA;AACI,IAAA,MAAMqX,KAAK,CAAC;AACVxS,MAAAA,WAAWA,GAAG;AACZ,QAAA,IAAI,CAAC0E,KAAK,GAAG,EAAE;AACf,QAAA,IAAI,CAAC0N,OAAO,GAAG,EAAE;AACjB,QAAA,IAAI,CAACK,WAAW,GAAG,IAAIzD,GAAG,EAAE;QAC5B,IAAI,CAAC0D,SAAS,GAAG,EAAE;QACnB,IAAI,CAACJ,WAAW,GAAG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"}